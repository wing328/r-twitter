#' Twitter API v2
#'
#' Twitter API v2 available endpoints
#'
#' The version of the OpenAPI document: 2.49
#' Generated by: https://openapi-generator.tech
#'
#' @docType class
#' @title Lists operations
#' @description ListsApi
#' @format An \code{R6Class} generator object
#' @field api_client Handles the client-server communication.
#'
#' @section Methods:
#' \describe{
#' \strong{ get_user_list_memberships } \emph{ Get a User&#39;s List Memberships }
#' Get a User's List Memberships.
#'
#' \itemize{
#' \item \emph{ @param } id character
#' \item \emph{ @param } max_results integer
#' \item \emph{ @param } pagination_token character
#' \item \emph{ @param } list_fields Enum < [created_at, description, follower_count, id, member_count, name, owner_id, private] >
#' \item \emph{ @param } expansions Enum < [owner_id] >
#' \item \emph{ @param } user_fields Enum < [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld] >
#' \item \emph{ @returnType } \link{Get2UsersIdListMembershipsResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : Get2UsersIdListMembershipsResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ list_add_member } \emph{ Add a List member }
#' Causes a User to become a member of a List.
#'
#' \itemize{
#' \item \emph{ @param } id character
#' \item \emph{ @param } list_add_user_request \link{ListAddUserRequest}
#' \item \emph{ @returnType } \link{ListMutateResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : ListMutateResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ list_id_create } \emph{ Create List }
#' Creates a new List.
#'
#' \itemize{
#' \item \emph{ @param } list_create_request \link{ListCreateRequest}
#' \item \emph{ @returnType } \link{ListCreateResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : ListCreateResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ list_id_delete } \emph{ Delete List }
#' Delete a List that you own.
#'
#' \itemize{
#' \item \emph{ @param } id character
#' \item \emph{ @returnType } \link{ListDeleteResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : ListDeleteResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ list_id_get } \emph{ List lookup by List ID. }
#' Returns a List.
#'
#' \itemize{
#' \item \emph{ @param } id character
#' \item \emph{ @param } list_fields Enum < [created_at, description, follower_count, id, member_count, name, owner_id, private] >
#' \item \emph{ @param } expansions Enum < [owner_id] >
#' \item \emph{ @param } user_fields Enum < [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld] >
#' \item \emph{ @returnType } \link{Get2ListsIdResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : Get2ListsIdResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ list_id_update } \emph{ Update List. }
#' Update a List that you own.
#'
#' \itemize{
#' \item \emph{ @param } id character
#' \item \emph{ @param } list_update_request \link{ListUpdateRequest}
#' \item \emph{ @returnType } \link{ListUpdateResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : ListUpdateResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ list_remove_member } \emph{ Remove a List member }
#' Causes a User to be removed from the members of a List.
#'
#' \itemize{
#' \item \emph{ @param } id character
#' \item \emph{ @param } user_id character
#' \item \emph{ @returnType } \link{ListMutateResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : ListMutateResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ list_user_follow } \emph{ Follow a List }
#' Causes a User to follow a List.
#'
#' \itemize{
#' \item \emph{ @param } id character
#' \item \emph{ @param } list_followed_request \link{ListFollowedRequest}
#' \item \emph{ @returnType } \link{ListFollowedResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : ListFollowedResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ list_user_owned_lists } \emph{ Get a User&#39;s Owned Lists. }
#' Get a User's Owned Lists.
#'
#' \itemize{
#' \item \emph{ @param } id character
#' \item \emph{ @param } max_results integer
#' \item \emph{ @param } pagination_token character
#' \item \emph{ @param } list_fields Enum < [created_at, description, follower_count, id, member_count, name, owner_id, private] >
#' \item \emph{ @param } expansions Enum < [owner_id] >
#' \item \emph{ @param } user_fields Enum < [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld] >
#' \item \emph{ @returnType } \link{Get2UsersIdOwnedListsResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : Get2UsersIdOwnedListsResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ list_user_pin } \emph{ Pin a List }
#' Causes a User to pin a List.
#'
#' \itemize{
#' \item \emph{ @param } id character
#' \item \emph{ @param } list_pinned_request \link{ListPinnedRequest}
#' \item \emph{ @returnType } \link{ListPinnedResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : ListPinnedResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ list_user_pinned_lists } \emph{ Get a User&#39;s Pinned Lists }
#' Get a User's Pinned Lists.
#'
#' \itemize{
#' \item \emph{ @param } id character
#' \item \emph{ @param } list_fields Enum < [created_at, description, follower_count, id, member_count, name, owner_id, private] >
#' \item \emph{ @param } expansions Enum < [owner_id] >
#' \item \emph{ @param } user_fields Enum < [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld] >
#' \item \emph{ @returnType } \link{Get2UsersIdPinnedListsResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : Get2UsersIdPinnedListsResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ list_user_unfollow } \emph{ Unfollow a List }
#' Causes a User to unfollow a List.
#'
#' \itemize{
#' \item \emph{ @param } id character
#' \item \emph{ @param } list_id character
#' \item \emph{ @returnType } \link{ListFollowedResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : ListFollowedResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ list_user_unpin } \emph{ Unpin a List }
#' Causes a User to remove a pinned List.
#'
#' \itemize{
#' \item \emph{ @param } id character
#' \item \emph{ @param } list_id character
#' \item \emph{ @returnType } \link{ListUnpinResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : ListUnpinResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ user_followed_lists } \emph{ Get User&#39;s Followed Lists }
#' Returns a User's followed Lists.
#'
#' \itemize{
#' \item \emph{ @param } id character
#' \item \emph{ @param } max_results integer
#' \item \emph{ @param } pagination_token character
#' \item \emph{ @param } list_fields Enum < [created_at, description, follower_count, id, member_count, name, owner_id, private] >
#' \item \emph{ @param } expansions Enum < [owner_id] >
#' \item \emph{ @param } user_fields Enum < [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld] >
#' \item \emph{ @returnType } \link{Get2UsersIdFollowedListsResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : Get2UsersIdFollowedListsResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' }
#'
#'
#' @examples
#' \dontrun{
#' ####################  get_user_list_memberships  ####################
#'
#' library(twitter)
#' var_id <- "2244994945" # character | The ID of the User to lookup.
#' var_max_results <- 100 # integer | The maximum number of results.
#' var_pagination_token <- "pagination_token_example" # character | This parameter is used to get a specified 'page' of results.
#' var_list_fields <- ["[\"created_at\",\"description\",\"follower_count\",\"id\",\"member_count\",\"name\",\"owner_id\",\"private\"]"] # set[character] | A comma separated list of List fields to display.
#' var_expansions <- ["[\"owner_id\"]"] # set[character] | A comma separated list of fields to expand.
#' var_user_fields <- ["[\"created_at\",\"description\",\"entities\",\"id\",\"location\",\"name\",\"pinned_tweet_id\",\"profile_image_url\",\"protected\",\"public_metrics\",\"url\",\"username\",\"verified\",\"withheld\"]"] # set[character] | A comma separated list of User fields to display.
#'
#' #Get a User's List Memberships
#' api_instance <- twitter_api$new()
#'
#' # Configure HTTP bearer authorization: BearerToken
#' api_instance$api_client$bearer_token <- Sys.getenv("BEARER_TOKEN")
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$lists_api$get_user_list_memberships(var_id, max_results = var_max_results, pagination_token = var_pagination_token, list_fields = var_list_fields, expansions = var_expansions, user_fields = var_user_fields, data_file = "result.txt"),
#'              
#'              
#'              api_instance$lists_api$get_user_list_memberships(var_id, max_results = var_max_results, pagination_token = var_pagination_token, list_fields = var_list_fields, expansions = var_expansions, user_fields = var_user_fields),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `get_user_list_memberships`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' ####################  list_add_member  ####################
#'
#' library(twitter)
#' var_id <- "id_example" # character | The ID of the List for which to add a member.
#' var_list_add_user_request <- ListAddUserRequest$new() # ListAddUserRequest | 
#'
#' #Add a List member
#' api_instance <- twitter_api$new()
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$lists_api$list_add_member(var_id, list_add_user_request = var_list_add_user_request, data_file = "result.txt"),
#'              
#'              
#'              api_instance$lists_api$list_add_member(var_id, list_add_user_request = var_list_add_user_request),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `list_add_member`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' ####################  list_id_create  ####################
#'
#' library(twitter)
#' var_list_create_request <- ListCreateRequest$new() # ListCreateRequest | 
#'
#' #Create List
#' api_instance <- twitter_api$new()
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$lists_api$list_id_create(list_create_request = var_list_create_request, data_file = "result.txt"),
#'              
#'              
#'              api_instance$lists_api$list_id_create(list_create_request = var_list_create_request),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `list_id_create`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' ####################  list_id_delete  ####################
#'
#' library(twitter)
#' var_id <- "id_example" # character | The ID of the List to delete.
#'
#' #Delete List
#' api_instance <- twitter_api$new()
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$lists_api$list_id_delete(var_id, data_file = "result.txt"),
#'              
#'              
#'              api_instance$lists_api$list_id_delete(var_id),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `list_id_delete`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' ####################  list_id_get  ####################
#'
#' library(twitter)
#' var_id <- "id_example" # character | The ID of the List.
#' var_list_fields <- ["[\"created_at\",\"description\",\"follower_count\",\"id\",\"member_count\",\"name\",\"owner_id\",\"private\"]"] # set[character] | A comma separated list of List fields to display.
#' var_expansions <- ["[\"owner_id\"]"] # set[character] | A comma separated list of fields to expand.
#' var_user_fields <- ["[\"created_at\",\"description\",\"entities\",\"id\",\"location\",\"name\",\"pinned_tweet_id\",\"profile_image_url\",\"protected\",\"public_metrics\",\"url\",\"username\",\"verified\",\"withheld\"]"] # set[character] | A comma separated list of User fields to display.
#'
#' #List lookup by List ID.
#' api_instance <- twitter_api$new()
#'
#' # Configure HTTP bearer authorization: BearerToken
#' api_instance$api_client$bearer_token <- Sys.getenv("BEARER_TOKEN")
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$lists_api$list_id_get(var_id, list_fields = var_list_fields, expansions = var_expansions, user_fields = var_user_fields, data_file = "result.txt"),
#'              
#'              
#'              api_instance$lists_api$list_id_get(var_id, list_fields = var_list_fields, expansions = var_expansions, user_fields = var_user_fields),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `list_id_get`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' ####################  list_id_update  ####################
#'
#' library(twitter)
#' var_id <- "id_example" # character | The ID of the List to modify.
#' var_list_update_request <- ListUpdateRequest$new() # ListUpdateRequest | 
#'
#' #Update List.
#' api_instance <- twitter_api$new()
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$lists_api$list_id_update(var_id, list_update_request = var_list_update_request, data_file = "result.txt"),
#'              
#'              
#'              api_instance$lists_api$list_id_update(var_id, list_update_request = var_list_update_request),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `list_id_update`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' ####################  list_remove_member  ####################
#'
#' library(twitter)
#' var_id <- "id_example" # character | The ID of the List to remove a member.
#' var_user_id <- "user_id_example" # character | The ID of User that will be removed from the List.
#'
#' #Remove a List member
#' api_instance <- twitter_api$new()
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$lists_api$list_remove_member(var_id, var_user_id, data_file = "result.txt"),
#'              
#'              
#'              api_instance$lists_api$list_remove_member(var_id, var_user_id),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `list_remove_member`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' ####################  list_user_follow  ####################
#'
#' library(twitter)
#' var_id <- "id_example" # character | The ID of the authenticated source User that will follow the List.
#' var_list_followed_request <- ListFollowedRequest$new() # ListFollowedRequest | 
#'
#' #Follow a List
#' api_instance <- twitter_api$new()
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$lists_api$list_user_follow(var_id, list_followed_request = var_list_followed_request, data_file = "result.txt"),
#'              
#'              
#'              api_instance$lists_api$list_user_follow(var_id, list_followed_request = var_list_followed_request),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `list_user_follow`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' ####################  list_user_owned_lists  ####################
#'
#' library(twitter)
#' var_id <- "2244994945" # character | The ID of the User to lookup.
#' var_max_results <- 100 # integer | The maximum number of results.
#' var_pagination_token <- "pagination_token_example" # character | This parameter is used to get a specified 'page' of results.
#' var_list_fields <- ["[\"created_at\",\"description\",\"follower_count\",\"id\",\"member_count\",\"name\",\"owner_id\",\"private\"]"] # set[character] | A comma separated list of List fields to display.
#' var_expansions <- ["[\"owner_id\"]"] # set[character] | A comma separated list of fields to expand.
#' var_user_fields <- ["[\"created_at\",\"description\",\"entities\",\"id\",\"location\",\"name\",\"pinned_tweet_id\",\"profile_image_url\",\"protected\",\"public_metrics\",\"url\",\"username\",\"verified\",\"withheld\"]"] # set[character] | A comma separated list of User fields to display.
#'
#' #Get a User's Owned Lists.
#' api_instance <- twitter_api$new()
#'
#' # Configure HTTP bearer authorization: BearerToken
#' api_instance$api_client$bearer_token <- Sys.getenv("BEARER_TOKEN")
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$lists_api$list_user_owned_lists(var_id, max_results = var_max_results, pagination_token = var_pagination_token, list_fields = var_list_fields, expansions = var_expansions, user_fields = var_user_fields, data_file = "result.txt"),
#'              
#'              
#'              api_instance$lists_api$list_user_owned_lists(var_id, max_results = var_max_results, pagination_token = var_pagination_token, list_fields = var_list_fields, expansions = var_expansions, user_fields = var_user_fields),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `list_user_owned_lists`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' ####################  list_user_pin  ####################
#'
#' library(twitter)
#' var_id <- "id_example" # character | The ID of the authenticated source User that will pin the List.
#' var_list_pinned_request <- ListPinnedRequest$new() # ListPinnedRequest | 
#'
#' #Pin a List
#' api_instance <- twitter_api$new()
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$lists_api$list_user_pin(var_id, var_list_pinned_request, data_file = "result.txt"),
#'              
#'              
#'              api_instance$lists_api$list_user_pin(var_id, var_list_pinned_request),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `list_user_pin`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' ####################  list_user_pinned_lists  ####################
#'
#' library(twitter)
#' var_id <- "id_example" # character | The ID of the authenticated source User for whom to return results.
#' var_list_fields <- ["[\"created_at\",\"description\",\"follower_count\",\"id\",\"member_count\",\"name\",\"owner_id\",\"private\"]"] # set[character] | A comma separated list of List fields to display.
#' var_expansions <- ["[\"owner_id\"]"] # set[character] | A comma separated list of fields to expand.
#' var_user_fields <- ["[\"created_at\",\"description\",\"entities\",\"id\",\"location\",\"name\",\"pinned_tweet_id\",\"profile_image_url\",\"protected\",\"public_metrics\",\"url\",\"username\",\"verified\",\"withheld\"]"] # set[character] | A comma separated list of User fields to display.
#'
#' #Get a User's Pinned Lists
#' api_instance <- twitter_api$new()
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$lists_api$list_user_pinned_lists(var_id, list_fields = var_list_fields, expansions = var_expansions, user_fields = var_user_fields, data_file = "result.txt"),
#'              
#'              
#'              api_instance$lists_api$list_user_pinned_lists(var_id, list_fields = var_list_fields, expansions = var_expansions, user_fields = var_user_fields),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `list_user_pinned_lists`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' ####################  list_user_unfollow  ####################
#'
#' library(twitter)
#' var_id <- "id_example" # character | The ID of the authenticated source User that will unfollow the List.
#' var_list_id <- "list_id_example" # character | The ID of the List to unfollow.
#'
#' #Unfollow a List
#' api_instance <- twitter_api$new()
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$lists_api$list_user_unfollow(var_id, var_list_id, data_file = "result.txt"),
#'              
#'              
#'              api_instance$lists_api$list_user_unfollow(var_id, var_list_id),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `list_user_unfollow`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' ####################  list_user_unpin  ####################
#'
#' library(twitter)
#' var_id <- "id_example" # character | The ID of the authenticated source User for whom to return results.
#' var_list_id <- "list_id_example" # character | The ID of the List to unpin.
#'
#' #Unpin a List
#' api_instance <- twitter_api$new()
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$lists_api$list_user_unpin(var_id, var_list_id, data_file = "result.txt"),
#'              
#'              
#'              api_instance$lists_api$list_user_unpin(var_id, var_list_id),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `list_user_unpin`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' ####################  user_followed_lists  ####################
#'
#' library(twitter)
#' var_id <- "2244994945" # character | The ID of the User to lookup.
#' var_max_results <- 100 # integer | The maximum number of results.
#' var_pagination_token <- "pagination_token_example" # character | This parameter is used to get a specified 'page' of results.
#' var_list_fields <- ["[\"created_at\",\"description\",\"follower_count\",\"id\",\"member_count\",\"name\",\"owner_id\",\"private\"]"] # set[character] | A comma separated list of List fields to display.
#' var_expansions <- ["[\"owner_id\"]"] # set[character] | A comma separated list of fields to expand.
#' var_user_fields <- ["[\"created_at\",\"description\",\"entities\",\"id\",\"location\",\"name\",\"pinned_tweet_id\",\"profile_image_url\",\"protected\",\"public_metrics\",\"url\",\"username\",\"verified\",\"withheld\"]"] # set[character] | A comma separated list of User fields to display.
#'
#' #Get User's Followed Lists
#' api_instance <- twitter_api$new()
#'
#' # Configure HTTP bearer authorization: BearerToken
#' api_instance$api_client$bearer_token <- Sys.getenv("BEARER_TOKEN")
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$lists_api$user_followed_lists(var_id, max_results = var_max_results, pagination_token = var_pagination_token, list_fields = var_list_fields, expansions = var_expansions, user_fields = var_user_fields, data_file = "result.txt"),
#'              
#'              
#'              api_instance$lists_api$user_followed_lists(var_id, max_results = var_max_results, pagination_token = var_pagination_token, list_fields = var_list_fields, expansions = var_expansions, user_fields = var_user_fields),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `user_followed_lists`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' }
#' @importFrom R6 R6Class
#' @importFrom base64enc base64encode
#' @importFrom rlang abort
#' @export
ListsApi <- R6::R6Class(
  "ListsApi",
  public = list(
    api_client = NULL,
    #' Initialize a new ListsApi.
    #'
    #' @description
    #' Initialize a new ListsApi.
    #'
    #' @param api_client An instance of API client.
    #' @export
    initialize = function(api_client) {
      if (!missing(api_client)) {
        self$api_client <- api_client
      } else {
        self$api_client <- ApiClient$new()
      }
    },
    #' Get a User's List Memberships
    #'
    #' @description
    #' Get a User's List Memberships
    #'
    #' @param id The ID of the User to lookup.
    #' @param max_results (optional) The maximum number of results. (default value: 100)
    #' @param pagination_token (optional) This parameter is used to get a specified 'page' of results.
    #' @param list_fields (optional) A comma separated list of List fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return Get2UsersIdListMembershipsResponse
    #' @export
    get_user_list_memberships = function(id, max_results = 100, pagination_token = NULL, list_fields = NULL, expansions = NULL, user_fields = NULL, data_file = NULL, ...) {
      local_var_response <- self$get_user_list_memberships_with_http_info(id, max_results, pagination_token, list_fields, expansions, user_fields, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Get a User's List Memberships
    #'
    #' @description
    #' Get a User's List Memberships
    #'
    #' @param id The ID of the User to lookup.
    #' @param max_results (optional) The maximum number of results. (default value: 100)
    #' @param pagination_token (optional) This parameter is used to get a specified 'page' of results.
    #' @param list_fields (optional) A comma separated list of List fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (Get2UsersIdListMembershipsResponse) with additional information such as HTTP status code, headers
    #' @export
    get_user_list_memberships_with_http_info = function(id, max_results = 100, pagination_token = NULL, list_fields = NULL, expansions = NULL, user_fields = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`id`)) {
        rlang::abort(message = "Missing required parameter `id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `id`."))
      }

      if (!str_detect(`id`, "^[0-9]{1,19}$")) {
        rlang::abort(message = "Invalid value for `id` when calling ListsApi$get_user_list_memberships, must conform to the pattern ^[0-9]{1,19}$.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `id` when calling ListsApi$get_user_list_memberships, must conform to the pattern ^[0-9]{1,19}$."))
      }

      if (`max_results` > 100) {
        rlang::abort(message = "Invalid value for `max_results` when calling ListsApi$get_user_list_memberships, must be smaller than or equal to 100.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `max_results` when calling ListsApi$get_user_list_memberships, must be smaller than or equal to 100."))
      }
      if (`max_results` < 1) {
        rlang::abort(message = "Invalid value for `max_results` when calling ListsApi$get_user_list_memberships, must be bigger than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `max_results` when calling ListsApi$get_user_list_memberships, must be bigger than or equal to 1."))
      }

      if (nchar(`pagination_token`) > 19) {
        rlang::abort(message = "Invalid length for `pagination_token` when calling ListsApi$get_user_list_memberships, must be smaller than or equal to 19.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for $pagination_token when calling ListsApi.get_user_list_memberships, must be smaller than or equal to 19."))
      }
      if (nchar(`pagination_token`) < 1) {
        rlang::abort(message = "Invalid length for `pagination_token` when calling ListsApi$get_user_list_memberships, must be bigger than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `pagination_token` when calling ListsApi$get_user_list_memberships, must be bigger than or equal to 1."))
      }

      if (length(`list_fields`) < 1) {
        rlang::abort(message = "Invalid length for `list_fields` when calling ListsApi$get_user_list_memberships, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `list_fields` when calling ListsApi$get_user_list_memberships, number of items must be greater than or equal to 1."))
      }

      if (length(`expansions`) < 1) {
        rlang::abort(message = "Invalid length for `expansions` when calling ListsApi$get_user_list_memberships, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `expansions` when calling ListsApi$get_user_list_memberships, number of items must be greater than or equal to 1."))
      }

      if (length(`user_fields`) < 1) {
        rlang::abort(message = "Invalid length for `user_fields` when calling ListsApi$get_user_list_memberships, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `user_fields` when calling ListsApi$get_user_list_memberships, number of items must be greater than or equal to 1."))
      }

      query_params[["max_results"]] <- `max_results`

      query_params[["pagination_token"]] <- `pagination_token`

      # check if items are unique
      if (!identical(`list_fields`, unique(`list_fields`))) {
        rlang::abort(message = "Invalid value for `list_fields` when calling ListsApi$get_user_list_memberships. Items must be unique.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `list_fields` when calling ListsApi$get_user_list_memberships. Items must be unique."))
      }
      # no explore
      # validate enum values
      for (query_item in `list_fields`) {
        if (!(query_item %in% c("created_at", "description", "follower_count", "id", "member_count", "name", "owner_id", "private"))) {
          rlang::abort(message = "Invalid value for `list_fields` when calling ListsApi$get_user_list_memberships. Must be [created_at, description, follower_count, id, member_count, name, owner_id, private].",
                       .subclass = "ApiException",
                       ApiException = ApiException$new(status = 0,
                                                       reason = "Invalid value for `list_fields` when calling ListsApi$get_user_list_memberships. Must be [created_at, description, follower_count, id, member_count, name, owner_id, private]."))
        }
      }
      query_params[["list.fields"]] <- I(paste(lapply(`list_fields`, URLencode, reserved = TRUE), collapse = ","))

      # check if items are unique
      if (!identical(`expansions`, unique(`expansions`))) {
        rlang::abort(message = "Invalid value for `expansions` when calling ListsApi$get_user_list_memberships. Items must be unique.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `expansions` when calling ListsApi$get_user_list_memberships. Items must be unique."))
      }
      # no explore
      # validate enum values
      for (query_item in `expansions`) {
        if (!(query_item %in% c("owner_id"))) {
          rlang::abort(message = "Invalid value for `expansions` when calling ListsApi$get_user_list_memberships. Must be [owner_id].",
                       .subclass = "ApiException",
                       ApiException = ApiException$new(status = 0,
                                                       reason = "Invalid value for `expansions` when calling ListsApi$get_user_list_memberships. Must be [owner_id]."))
        }
      }
      query_params[["expansions"]] <- I(paste(lapply(`expansions`, URLencode, reserved = TRUE), collapse = ","))

      # check if items are unique
      if (!identical(`user_fields`, unique(`user_fields`))) {
        rlang::abort(message = "Invalid value for `user_fields` when calling ListsApi$get_user_list_memberships. Items must be unique.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `user_fields` when calling ListsApi$get_user_list_memberships. Items must be unique."))
      }
      # no explore
      # validate enum values
      for (query_item in `user_fields`) {
        if (!(query_item %in% c("created_at", "description", "entities", "id", "location", "name", "pinned_tweet_id", "profile_image_url", "protected", "public_metrics", "url", "username", "verified", "withheld"))) {
          rlang::abort(message = "Invalid value for `user_fields` when calling ListsApi$get_user_list_memberships. Must be [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld].",
                       .subclass = "ApiException",
                       ApiException = ApiException$new(status = 0,
                                                       reason = "Invalid value for `user_fields` when calling ListsApi$get_user_list_memberships. Must be [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld]."))
        }
      }
      query_params[["user.fields"]] <- I(paste(lapply(`user_fields`, URLencode, reserved = TRUE), collapse = ","))

      local_var_url_path <- "/2/users/{id}/list_memberships"
      if (!missing(`id`)) {
        local_var_url_path <- gsub("\\{id\\}", URLencode(as.character(`id`), reserved = TRUE), local_var_url_path)
      }

      # Bearer token
      if (!is.null(self$api_client$bearer_token)) {
        header_params["Authorization"] <- paste("Bearer", self$api_client$bearer_token, sep = " ")
      }
      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read list.read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "Get2UsersIdListMembershipsResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    },
    #' Add a List member
    #'
    #' @description
    #' Add a List member
    #'
    #' @param id The ID of the List for which to add a member.
    #' @param list_add_user_request (optional) No description
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return ListMutateResponse
    #' @export
    list_add_member = function(id, list_add_user_request = NULL, data_file = NULL, ...) {
      local_var_response <- self$list_add_member_with_http_info(id, list_add_user_request, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Add a List member
    #'
    #' @description
    #' Add a List member
    #'
    #' @param id The ID of the List for which to add a member.
    #' @param list_add_user_request (optional) No description
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (ListMutateResponse) with additional information such as HTTP status code, headers
    #' @export
    list_add_member_with_http_info = function(id, list_add_user_request = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`id`)) {
        rlang::abort(message = "Missing required parameter `id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `id`."))
      }

      if (!str_detect(`id`, "^[0-9]{1,19}$")) {
        rlang::abort(message = "Invalid value for `id` when calling ListsApi$list_add_member, must conform to the pattern ^[0-9]{1,19}$.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `id` when calling ListsApi$list_add_member, must conform to the pattern ^[0-9]{1,19}$."))
      }


      if (!missing(`list_add_user_request`)) {
        local_var_body <- `list_add_user_request`$toJSONString()
      } else {
        body <- NULL
      }

      local_var_url_path <- "/2/lists/{id}/members"
      if (!missing(`id`)) {
        local_var_url_path <- gsub("\\{id\\}", URLencode(as.character(`id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read list.write"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list("application/json")

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "POST",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "ListMutateResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    },
    #' Create List
    #'
    #' @description
    #' Create List
    #'
    #' @param list_create_request (optional) No description
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return ListCreateResponse
    #' @export
    list_id_create = function(list_create_request = NULL, data_file = NULL, ...) {
      local_var_response <- self$list_id_create_with_http_info(list_create_request, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Create List
    #'
    #' @description
    #' Create List
    #'
    #' @param list_create_request (optional) No description
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (ListCreateResponse) with additional information such as HTTP status code, headers
    #' @export
    list_id_create_with_http_info = function(list_create_request = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE


      if (!missing(`list_create_request`)) {
        local_var_body <- `list_create_request`$toJSONString()
      } else {
        body <- NULL
      }

      local_var_url_path <- "/2/lists"
      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read list.write list.read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list("application/json")

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "POST",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "ListCreateResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    },
    #' Delete List
    #'
    #' @description
    #' Delete List
    #'
    #' @param id The ID of the List to delete.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return ListDeleteResponse
    #' @export
    list_id_delete = function(id, data_file = NULL, ...) {
      local_var_response <- self$list_id_delete_with_http_info(id, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Delete List
    #'
    #' @description
    #' Delete List
    #'
    #' @param id The ID of the List to delete.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (ListDeleteResponse) with additional information such as HTTP status code, headers
    #' @export
    list_id_delete_with_http_info = function(id, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`id`)) {
        rlang::abort(message = "Missing required parameter `id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `id`."))
      }

      if (!str_detect(`id`, "^[0-9]{1,19}$")) {
        rlang::abort(message = "Invalid value for `id` when calling ListsApi$list_id_delete, must conform to the pattern ^[0-9]{1,19}$.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `id` when calling ListsApi$list_id_delete, must conform to the pattern ^[0-9]{1,19}$."))
      }

      local_var_url_path <- "/2/lists/{id}"
      if (!missing(`id`)) {
        local_var_url_path <- gsub("\\{id\\}", URLencode(as.character(`id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read list.write"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "DELETE",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "ListDeleteResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    },
    #' List lookup by List ID.
    #'
    #' @description
    #' List lookup by List ID.
    #'
    #' @param id The ID of the List.
    #' @param list_fields (optional) A comma separated list of List fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return Get2ListsIdResponse
    #' @export
    list_id_get = function(id, list_fields = NULL, expansions = NULL, user_fields = NULL, data_file = NULL, ...) {
      local_var_response <- self$list_id_get_with_http_info(id, list_fields, expansions, user_fields, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' List lookup by List ID.
    #'
    #' @description
    #' List lookup by List ID.
    #'
    #' @param id The ID of the List.
    #' @param list_fields (optional) A comma separated list of List fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (Get2ListsIdResponse) with additional information such as HTTP status code, headers
    #' @export
    list_id_get_with_http_info = function(id, list_fields = NULL, expansions = NULL, user_fields = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`id`)) {
        rlang::abort(message = "Missing required parameter `id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `id`."))
      }

      if (!str_detect(`id`, "^[0-9]{1,19}$")) {
        rlang::abort(message = "Invalid value for `id` when calling ListsApi$list_id_get, must conform to the pattern ^[0-9]{1,19}$.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `id` when calling ListsApi$list_id_get, must conform to the pattern ^[0-9]{1,19}$."))
      }

      if (length(`list_fields`) < 1) {
        rlang::abort(message = "Invalid length for `list_fields` when calling ListsApi$list_id_get, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `list_fields` when calling ListsApi$list_id_get, number of items must be greater than or equal to 1."))
      }

      if (length(`expansions`) < 1) {
        rlang::abort(message = "Invalid length for `expansions` when calling ListsApi$list_id_get, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `expansions` when calling ListsApi$list_id_get, number of items must be greater than or equal to 1."))
      }

      if (length(`user_fields`) < 1) {
        rlang::abort(message = "Invalid length for `user_fields` when calling ListsApi$list_id_get, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `user_fields` when calling ListsApi$list_id_get, number of items must be greater than or equal to 1."))
      }

      # check if items are unique
      if (!identical(`list_fields`, unique(`list_fields`))) {
        rlang::abort(message = "Invalid value for `list_fields` when calling ListsApi$list_id_get. Items must be unique.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `list_fields` when calling ListsApi$list_id_get. Items must be unique."))
      }
      # no explore
      # validate enum values
      for (query_item in `list_fields`) {
        if (!(query_item %in% c("created_at", "description", "follower_count", "id", "member_count", "name", "owner_id", "private"))) {
          rlang::abort(message = "Invalid value for `list_fields` when calling ListsApi$list_id_get. Must be [created_at, description, follower_count, id, member_count, name, owner_id, private].",
                       .subclass = "ApiException",
                       ApiException = ApiException$new(status = 0,
                                                       reason = "Invalid value for `list_fields` when calling ListsApi$list_id_get. Must be [created_at, description, follower_count, id, member_count, name, owner_id, private]."))
        }
      }
      query_params[["list.fields"]] <- I(paste(lapply(`list_fields`, URLencode, reserved = TRUE), collapse = ","))

      # check if items are unique
      if (!identical(`expansions`, unique(`expansions`))) {
        rlang::abort(message = "Invalid value for `expansions` when calling ListsApi$list_id_get. Items must be unique.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `expansions` when calling ListsApi$list_id_get. Items must be unique."))
      }
      # no explore
      # validate enum values
      for (query_item in `expansions`) {
        if (!(query_item %in% c("owner_id"))) {
          rlang::abort(message = "Invalid value for `expansions` when calling ListsApi$list_id_get. Must be [owner_id].",
                       .subclass = "ApiException",
                       ApiException = ApiException$new(status = 0,
                                                       reason = "Invalid value for `expansions` when calling ListsApi$list_id_get. Must be [owner_id]."))
        }
      }
      query_params[["expansions"]] <- I(paste(lapply(`expansions`, URLencode, reserved = TRUE), collapse = ","))

      # check if items are unique
      if (!identical(`user_fields`, unique(`user_fields`))) {
        rlang::abort(message = "Invalid value for `user_fields` when calling ListsApi$list_id_get. Items must be unique.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `user_fields` when calling ListsApi$list_id_get. Items must be unique."))
      }
      # no explore
      # validate enum values
      for (query_item in `user_fields`) {
        if (!(query_item %in% c("created_at", "description", "entities", "id", "location", "name", "pinned_tweet_id", "profile_image_url", "protected", "public_metrics", "url", "username", "verified", "withheld"))) {
          rlang::abort(message = "Invalid value for `user_fields` when calling ListsApi$list_id_get. Must be [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld].",
                       .subclass = "ApiException",
                       ApiException = ApiException$new(status = 0,
                                                       reason = "Invalid value for `user_fields` when calling ListsApi$list_id_get. Must be [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld]."))
        }
      }
      query_params[["user.fields"]] <- I(paste(lapply(`user_fields`, URLencode, reserved = TRUE), collapse = ","))

      local_var_url_path <- "/2/lists/{id}"
      if (!missing(`id`)) {
        local_var_url_path <- gsub("\\{id\\}", URLencode(as.character(`id`), reserved = TRUE), local_var_url_path)
      }

      # Bearer token
      if (!is.null(self$api_client$bearer_token)) {
        header_params["Authorization"] <- paste("Bearer", self$api_client$bearer_token, sep = " ")
      }
      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read list.read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "Get2ListsIdResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    },
    #' Update List.
    #'
    #' @description
    #' Update List.
    #'
    #' @param id The ID of the List to modify.
    #' @param list_update_request (optional) No description
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return ListUpdateResponse
    #' @export
    list_id_update = function(id, list_update_request = NULL, data_file = NULL, ...) {
      local_var_response <- self$list_id_update_with_http_info(id, list_update_request, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Update List.
    #'
    #' @description
    #' Update List.
    #'
    #' @param id The ID of the List to modify.
    #' @param list_update_request (optional) No description
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (ListUpdateResponse) with additional information such as HTTP status code, headers
    #' @export
    list_id_update_with_http_info = function(id, list_update_request = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`id`)) {
        rlang::abort(message = "Missing required parameter `id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `id`."))
      }

      if (!str_detect(`id`, "^[0-9]{1,19}$")) {
        rlang::abort(message = "Invalid value for `id` when calling ListsApi$list_id_update, must conform to the pattern ^[0-9]{1,19}$.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `id` when calling ListsApi$list_id_update, must conform to the pattern ^[0-9]{1,19}$."))
      }


      if (!missing(`list_update_request`)) {
        local_var_body <- `list_update_request`$toJSONString()
      } else {
        body <- NULL
      }

      local_var_url_path <- "/2/lists/{id}"
      if (!missing(`id`)) {
        local_var_url_path <- gsub("\\{id\\}", URLencode(as.character(`id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read list.write"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list("application/json")

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "PUT",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "ListUpdateResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    },
    #' Remove a List member
    #'
    #' @description
    #' Remove a List member
    #'
    #' @param id The ID of the List to remove a member.
    #' @param user_id The ID of User that will be removed from the List.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return ListMutateResponse
    #' @export
    list_remove_member = function(id, user_id, data_file = NULL, ...) {
      local_var_response <- self$list_remove_member_with_http_info(id, user_id, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Remove a List member
    #'
    #' @description
    #' Remove a List member
    #'
    #' @param id The ID of the List to remove a member.
    #' @param user_id The ID of User that will be removed from the List.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (ListMutateResponse) with additional information such as HTTP status code, headers
    #' @export
    list_remove_member_with_http_info = function(id, user_id, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`id`)) {
        rlang::abort(message = "Missing required parameter `id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `id`."))
      }

      if (missing(`user_id`)) {
        rlang::abort(message = "Missing required parameter `user_id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `user_id`."))
      }

      if (!str_detect(`id`, "^[0-9]{1,19}$")) {
        rlang::abort(message = "Invalid value for `id` when calling ListsApi$list_remove_member, must conform to the pattern ^[0-9]{1,19}$.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `id` when calling ListsApi$list_remove_member, must conform to the pattern ^[0-9]{1,19}$."))
      }

      if (!str_detect(`user_id`, "^[0-9]{1,19}$")) {
        rlang::abort(message = "Invalid value for `user_id` when calling ListsApi$list_remove_member, must conform to the pattern ^[0-9]{1,19}$.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `user_id` when calling ListsApi$list_remove_member, must conform to the pattern ^[0-9]{1,19}$."))
      }

      local_var_url_path <- "/2/lists/{id}/members/{user_id}"
      if (!missing(`id`)) {
        local_var_url_path <- gsub("\\{id\\}", URLencode(as.character(`id`), reserved = TRUE), local_var_url_path)
      }

      if (!missing(`user_id`)) {
        local_var_url_path <- gsub("\\{user_id\\}", URLencode(as.character(`user_id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read list.write"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "DELETE",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "ListMutateResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    },
    #' Follow a List
    #'
    #' @description
    #' Follow a List
    #'
    #' @param id The ID of the authenticated source User that will follow the List.
    #' @param list_followed_request (optional) No description
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return ListFollowedResponse
    #' @export
    list_user_follow = function(id, list_followed_request = NULL, data_file = NULL, ...) {
      local_var_response <- self$list_user_follow_with_http_info(id, list_followed_request, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Follow a List
    #'
    #' @description
    #' Follow a List
    #'
    #' @param id The ID of the authenticated source User that will follow the List.
    #' @param list_followed_request (optional) No description
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (ListFollowedResponse) with additional information such as HTTP status code, headers
    #' @export
    list_user_follow_with_http_info = function(id, list_followed_request = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`id`)) {
        rlang::abort(message = "Missing required parameter `id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `id`."))
      }



      if (!missing(`list_followed_request`)) {
        local_var_body <- `list_followed_request`$toJSONString()
      } else {
        body <- NULL
      }

      local_var_url_path <- "/2/users/{id}/followed_lists"
      if (!missing(`id`)) {
        local_var_url_path <- gsub("\\{id\\}", URLencode(as.character(`id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read list.write"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list("application/json")

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "POST",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "ListFollowedResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    },
    #' Get a User's Owned Lists.
    #'
    #' @description
    #' Get a User's Owned Lists.
    #'
    #' @param id The ID of the User to lookup.
    #' @param max_results (optional) The maximum number of results. (default value: 100)
    #' @param pagination_token (optional) This parameter is used to get a specified 'page' of results.
    #' @param list_fields (optional) A comma separated list of List fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return Get2UsersIdOwnedListsResponse
    #' @export
    list_user_owned_lists = function(id, max_results = 100, pagination_token = NULL, list_fields = NULL, expansions = NULL, user_fields = NULL, data_file = NULL, ...) {
      local_var_response <- self$list_user_owned_lists_with_http_info(id, max_results, pagination_token, list_fields, expansions, user_fields, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Get a User's Owned Lists.
    #'
    #' @description
    #' Get a User's Owned Lists.
    #'
    #' @param id The ID of the User to lookup.
    #' @param max_results (optional) The maximum number of results. (default value: 100)
    #' @param pagination_token (optional) This parameter is used to get a specified 'page' of results.
    #' @param list_fields (optional) A comma separated list of List fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (Get2UsersIdOwnedListsResponse) with additional information such as HTTP status code, headers
    #' @export
    list_user_owned_lists_with_http_info = function(id, max_results = 100, pagination_token = NULL, list_fields = NULL, expansions = NULL, user_fields = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`id`)) {
        rlang::abort(message = "Missing required parameter `id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `id`."))
      }

      if (!str_detect(`id`, "^[0-9]{1,19}$")) {
        rlang::abort(message = "Invalid value for `id` when calling ListsApi$list_user_owned_lists, must conform to the pattern ^[0-9]{1,19}$.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `id` when calling ListsApi$list_user_owned_lists, must conform to the pattern ^[0-9]{1,19}$."))
      }

      if (`max_results` > 100) {
        rlang::abort(message = "Invalid value for `max_results` when calling ListsApi$list_user_owned_lists, must be smaller than or equal to 100.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `max_results` when calling ListsApi$list_user_owned_lists, must be smaller than or equal to 100."))
      }
      if (`max_results` < 1) {
        rlang::abort(message = "Invalid value for `max_results` when calling ListsApi$list_user_owned_lists, must be bigger than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `max_results` when calling ListsApi$list_user_owned_lists, must be bigger than or equal to 1."))
      }

      if (nchar(`pagination_token`) > 19) {
        rlang::abort(message = "Invalid length for `pagination_token` when calling ListsApi$list_user_owned_lists, must be smaller than or equal to 19.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for $pagination_token when calling ListsApi.list_user_owned_lists, must be smaller than or equal to 19."))
      }
      if (nchar(`pagination_token`) < 1) {
        rlang::abort(message = "Invalid length for `pagination_token` when calling ListsApi$list_user_owned_lists, must be bigger than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `pagination_token` when calling ListsApi$list_user_owned_lists, must be bigger than or equal to 1."))
      }

      if (length(`list_fields`) < 1) {
        rlang::abort(message = "Invalid length for `list_fields` when calling ListsApi$list_user_owned_lists, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `list_fields` when calling ListsApi$list_user_owned_lists, number of items must be greater than or equal to 1."))
      }

      if (length(`expansions`) < 1) {
        rlang::abort(message = "Invalid length for `expansions` when calling ListsApi$list_user_owned_lists, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `expansions` when calling ListsApi$list_user_owned_lists, number of items must be greater than or equal to 1."))
      }

      if (length(`user_fields`) < 1) {
        rlang::abort(message = "Invalid length for `user_fields` when calling ListsApi$list_user_owned_lists, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `user_fields` when calling ListsApi$list_user_owned_lists, number of items must be greater than or equal to 1."))
      }

      query_params[["max_results"]] <- `max_results`

      query_params[["pagination_token"]] <- `pagination_token`

      # check if items are unique
      if (!identical(`list_fields`, unique(`list_fields`))) {
        rlang::abort(message = "Invalid value for `list_fields` when calling ListsApi$list_user_owned_lists. Items must be unique.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `list_fields` when calling ListsApi$list_user_owned_lists. Items must be unique."))
      }
      # no explore
      # validate enum values
      for (query_item in `list_fields`) {
        if (!(query_item %in% c("created_at", "description", "follower_count", "id", "member_count", "name", "owner_id", "private"))) {
          rlang::abort(message = "Invalid value for `list_fields` when calling ListsApi$list_user_owned_lists. Must be [created_at, description, follower_count, id, member_count, name, owner_id, private].",
                       .subclass = "ApiException",
                       ApiException = ApiException$new(status = 0,
                                                       reason = "Invalid value for `list_fields` when calling ListsApi$list_user_owned_lists. Must be [created_at, description, follower_count, id, member_count, name, owner_id, private]."))
        }
      }
      query_params[["list.fields"]] <- I(paste(lapply(`list_fields`, URLencode, reserved = TRUE), collapse = ","))

      # check if items are unique
      if (!identical(`expansions`, unique(`expansions`))) {
        rlang::abort(message = "Invalid value for `expansions` when calling ListsApi$list_user_owned_lists. Items must be unique.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `expansions` when calling ListsApi$list_user_owned_lists. Items must be unique."))
      }
      # no explore
      # validate enum values
      for (query_item in `expansions`) {
        if (!(query_item %in% c("owner_id"))) {
          rlang::abort(message = "Invalid value for `expansions` when calling ListsApi$list_user_owned_lists. Must be [owner_id].",
                       .subclass = "ApiException",
                       ApiException = ApiException$new(status = 0,
                                                       reason = "Invalid value for `expansions` when calling ListsApi$list_user_owned_lists. Must be [owner_id]."))
        }
      }
      query_params[["expansions"]] <- I(paste(lapply(`expansions`, URLencode, reserved = TRUE), collapse = ","))

      # check if items are unique
      if (!identical(`user_fields`, unique(`user_fields`))) {
        rlang::abort(message = "Invalid value for `user_fields` when calling ListsApi$list_user_owned_lists. Items must be unique.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `user_fields` when calling ListsApi$list_user_owned_lists. Items must be unique."))
      }
      # no explore
      # validate enum values
      for (query_item in `user_fields`) {
        if (!(query_item %in% c("created_at", "description", "entities", "id", "location", "name", "pinned_tweet_id", "profile_image_url", "protected", "public_metrics", "url", "username", "verified", "withheld"))) {
          rlang::abort(message = "Invalid value for `user_fields` when calling ListsApi$list_user_owned_lists. Must be [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld].",
                       .subclass = "ApiException",
                       ApiException = ApiException$new(status = 0,
                                                       reason = "Invalid value for `user_fields` when calling ListsApi$list_user_owned_lists. Must be [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld]."))
        }
      }
      query_params[["user.fields"]] <- I(paste(lapply(`user_fields`, URLencode, reserved = TRUE), collapse = ","))

      local_var_url_path <- "/2/users/{id}/owned_lists"
      if (!missing(`id`)) {
        local_var_url_path <- gsub("\\{id\\}", URLencode(as.character(`id`), reserved = TRUE), local_var_url_path)
      }

      # Bearer token
      if (!is.null(self$api_client$bearer_token)) {
        header_params["Authorization"] <- paste("Bearer", self$api_client$bearer_token, sep = " ")
      }
      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read list.read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "Get2UsersIdOwnedListsResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    },
    #' Pin a List
    #'
    #' @description
    #' Pin a List
    #'
    #' @param id The ID of the authenticated source User that will pin the List.
    #' @param list_pinned_request 
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return ListPinnedResponse
    #' @export
    list_user_pin = function(id, list_pinned_request, data_file = NULL, ...) {
      local_var_response <- self$list_user_pin_with_http_info(id, list_pinned_request, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Pin a List
    #'
    #' @description
    #' Pin a List
    #'
    #' @param id The ID of the authenticated source User that will pin the List.
    #' @param list_pinned_request 
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (ListPinnedResponse) with additional information such as HTTP status code, headers
    #' @export
    list_user_pin_with_http_info = function(id, list_pinned_request, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`id`)) {
        rlang::abort(message = "Missing required parameter `id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `id`."))
      }

      if (missing(`list_pinned_request`)) {
        rlang::abort(message = "Missing required parameter `list_pinned_request`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `list_pinned_request`."))
      }



      if (!missing(`list_pinned_request`)) {
        local_var_body <- `list_pinned_request`$toJSONString()
      } else {
        body <- NULL
      }

      local_var_url_path <- "/2/users/{id}/pinned_lists"
      if (!missing(`id`)) {
        local_var_url_path <- gsub("\\{id\\}", URLencode(as.character(`id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read list.write"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list("application/json")

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "POST",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "ListPinnedResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    },
    #' Get a User's Pinned Lists
    #'
    #' @description
    #' Get a User's Pinned Lists
    #'
    #' @param id The ID of the authenticated source User for whom to return results.
    #' @param list_fields (optional) A comma separated list of List fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return Get2UsersIdPinnedListsResponse
    #' @export
    list_user_pinned_lists = function(id, list_fields = NULL, expansions = NULL, user_fields = NULL, data_file = NULL, ...) {
      local_var_response <- self$list_user_pinned_lists_with_http_info(id, list_fields, expansions, user_fields, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Get a User's Pinned Lists
    #'
    #' @description
    #' Get a User's Pinned Lists
    #'
    #' @param id The ID of the authenticated source User for whom to return results.
    #' @param list_fields (optional) A comma separated list of List fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (Get2UsersIdPinnedListsResponse) with additional information such as HTTP status code, headers
    #' @export
    list_user_pinned_lists_with_http_info = function(id, list_fields = NULL, expansions = NULL, user_fields = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`id`)) {
        rlang::abort(message = "Missing required parameter `id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `id`."))
      }


      if (length(`list_fields`) < 1) {
        rlang::abort(message = "Invalid length for `list_fields` when calling ListsApi$list_user_pinned_lists, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `list_fields` when calling ListsApi$list_user_pinned_lists, number of items must be greater than or equal to 1."))
      }

      if (length(`expansions`) < 1) {
        rlang::abort(message = "Invalid length for `expansions` when calling ListsApi$list_user_pinned_lists, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `expansions` when calling ListsApi$list_user_pinned_lists, number of items must be greater than or equal to 1."))
      }

      if (length(`user_fields`) < 1) {
        rlang::abort(message = "Invalid length for `user_fields` when calling ListsApi$list_user_pinned_lists, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `user_fields` when calling ListsApi$list_user_pinned_lists, number of items must be greater than or equal to 1."))
      }

      # check if items are unique
      if (!identical(`list_fields`, unique(`list_fields`))) {
        rlang::abort(message = "Invalid value for `list_fields` when calling ListsApi$list_user_pinned_lists. Items must be unique.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `list_fields` when calling ListsApi$list_user_pinned_lists. Items must be unique."))
      }
      # no explore
      # validate enum values
      for (query_item in `list_fields`) {
        if (!(query_item %in% c("created_at", "description", "follower_count", "id", "member_count", "name", "owner_id", "private"))) {
          rlang::abort(message = "Invalid value for `list_fields` when calling ListsApi$list_user_pinned_lists. Must be [created_at, description, follower_count, id, member_count, name, owner_id, private].",
                       .subclass = "ApiException",
                       ApiException = ApiException$new(status = 0,
                                                       reason = "Invalid value for `list_fields` when calling ListsApi$list_user_pinned_lists. Must be [created_at, description, follower_count, id, member_count, name, owner_id, private]."))
        }
      }
      query_params[["list.fields"]] <- I(paste(lapply(`list_fields`, URLencode, reserved = TRUE), collapse = ","))

      # check if items are unique
      if (!identical(`expansions`, unique(`expansions`))) {
        rlang::abort(message = "Invalid value for `expansions` when calling ListsApi$list_user_pinned_lists. Items must be unique.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `expansions` when calling ListsApi$list_user_pinned_lists. Items must be unique."))
      }
      # no explore
      # validate enum values
      for (query_item in `expansions`) {
        if (!(query_item %in% c("owner_id"))) {
          rlang::abort(message = "Invalid value for `expansions` when calling ListsApi$list_user_pinned_lists. Must be [owner_id].",
                       .subclass = "ApiException",
                       ApiException = ApiException$new(status = 0,
                                                       reason = "Invalid value for `expansions` when calling ListsApi$list_user_pinned_lists. Must be [owner_id]."))
        }
      }
      query_params[["expansions"]] <- I(paste(lapply(`expansions`, URLencode, reserved = TRUE), collapse = ","))

      # check if items are unique
      if (!identical(`user_fields`, unique(`user_fields`))) {
        rlang::abort(message = "Invalid value for `user_fields` when calling ListsApi$list_user_pinned_lists. Items must be unique.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `user_fields` when calling ListsApi$list_user_pinned_lists. Items must be unique."))
      }
      # no explore
      # validate enum values
      for (query_item in `user_fields`) {
        if (!(query_item %in% c("created_at", "description", "entities", "id", "location", "name", "pinned_tweet_id", "profile_image_url", "protected", "public_metrics", "url", "username", "verified", "withheld"))) {
          rlang::abort(message = "Invalid value for `user_fields` when calling ListsApi$list_user_pinned_lists. Must be [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld].",
                       .subclass = "ApiException",
                       ApiException = ApiException$new(status = 0,
                                                       reason = "Invalid value for `user_fields` when calling ListsApi$list_user_pinned_lists. Must be [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld]."))
        }
      }
      query_params[["user.fields"]] <- I(paste(lapply(`user_fields`, URLencode, reserved = TRUE), collapse = ","))

      local_var_url_path <- "/2/users/{id}/pinned_lists"
      if (!missing(`id`)) {
        local_var_url_path <- gsub("\\{id\\}", URLencode(as.character(`id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read list.read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "Get2UsersIdPinnedListsResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    },
    #' Unfollow a List
    #'
    #' @description
    #' Unfollow a List
    #'
    #' @param id The ID of the authenticated source User that will unfollow the List.
    #' @param list_id The ID of the List to unfollow.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return ListFollowedResponse
    #' @export
    list_user_unfollow = function(id, list_id, data_file = NULL, ...) {
      local_var_response <- self$list_user_unfollow_with_http_info(id, list_id, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Unfollow a List
    #'
    #' @description
    #' Unfollow a List
    #'
    #' @param id The ID of the authenticated source User that will unfollow the List.
    #' @param list_id The ID of the List to unfollow.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (ListFollowedResponse) with additional information such as HTTP status code, headers
    #' @export
    list_user_unfollow_with_http_info = function(id, list_id, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`id`)) {
        rlang::abort(message = "Missing required parameter `id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `id`."))
      }

      if (missing(`list_id`)) {
        rlang::abort(message = "Missing required parameter `list_id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `list_id`."))
      }


      if (!str_detect(`list_id`, "^[0-9]{1,19}$")) {
        rlang::abort(message = "Invalid value for `list_id` when calling ListsApi$list_user_unfollow, must conform to the pattern ^[0-9]{1,19}$.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `list_id` when calling ListsApi$list_user_unfollow, must conform to the pattern ^[0-9]{1,19}$."))
      }

      local_var_url_path <- "/2/users/{id}/followed_lists/{list_id}"
      if (!missing(`id`)) {
        local_var_url_path <- gsub("\\{id\\}", URLencode(as.character(`id`), reserved = TRUE), local_var_url_path)
      }

      if (!missing(`list_id`)) {
        local_var_url_path <- gsub("\\{list_id\\}", URLencode(as.character(`list_id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read list.write"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "DELETE",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "ListFollowedResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    },
    #' Unpin a List
    #'
    #' @description
    #' Unpin a List
    #'
    #' @param id The ID of the authenticated source User for whom to return results.
    #' @param list_id The ID of the List to unpin.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return ListUnpinResponse
    #' @export
    list_user_unpin = function(id, list_id, data_file = NULL, ...) {
      local_var_response <- self$list_user_unpin_with_http_info(id, list_id, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Unpin a List
    #'
    #' @description
    #' Unpin a List
    #'
    #' @param id The ID of the authenticated source User for whom to return results.
    #' @param list_id The ID of the List to unpin.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (ListUnpinResponse) with additional information such as HTTP status code, headers
    #' @export
    list_user_unpin_with_http_info = function(id, list_id, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`id`)) {
        rlang::abort(message = "Missing required parameter `id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `id`."))
      }

      if (missing(`list_id`)) {
        rlang::abort(message = "Missing required parameter `list_id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `list_id`."))
      }


      if (!str_detect(`list_id`, "^[0-9]{1,19}$")) {
        rlang::abort(message = "Invalid value for `list_id` when calling ListsApi$list_user_unpin, must conform to the pattern ^[0-9]{1,19}$.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `list_id` when calling ListsApi$list_user_unpin, must conform to the pattern ^[0-9]{1,19}$."))
      }

      local_var_url_path <- "/2/users/{id}/pinned_lists/{list_id}"
      if (!missing(`id`)) {
        local_var_url_path <- gsub("\\{id\\}", URLencode(as.character(`id`), reserved = TRUE), local_var_url_path)
      }

      if (!missing(`list_id`)) {
        local_var_url_path <- gsub("\\{list_id\\}", URLencode(as.character(`list_id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read list.write"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "DELETE",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "ListUnpinResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    },
    #' Get User's Followed Lists
    #'
    #' @description
    #' Get User's Followed Lists
    #'
    #' @param id The ID of the User to lookup.
    #' @param max_results (optional) The maximum number of results. (default value: 100)
    #' @param pagination_token (optional) This parameter is used to get a specified 'page' of results.
    #' @param list_fields (optional) A comma separated list of List fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return Get2UsersIdFollowedListsResponse
    #' @export
    user_followed_lists = function(id, max_results = 100, pagination_token = NULL, list_fields = NULL, expansions = NULL, user_fields = NULL, data_file = NULL, ...) {
      local_var_response <- self$user_followed_lists_with_http_info(id, max_results, pagination_token, list_fields, expansions, user_fields, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Get User's Followed Lists
    #'
    #' @description
    #' Get User's Followed Lists
    #'
    #' @param id The ID of the User to lookup.
    #' @param max_results (optional) The maximum number of results. (default value: 100)
    #' @param pagination_token (optional) This parameter is used to get a specified 'page' of results.
    #' @param list_fields (optional) A comma separated list of List fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (Get2UsersIdFollowedListsResponse) with additional information such as HTTP status code, headers
    #' @export
    user_followed_lists_with_http_info = function(id, max_results = 100, pagination_token = NULL, list_fields = NULL, expansions = NULL, user_fields = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`id`)) {
        rlang::abort(message = "Missing required parameter `id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `id`."))
      }

      if (!str_detect(`id`, "^[0-9]{1,19}$")) {
        rlang::abort(message = "Invalid value for `id` when calling ListsApi$user_followed_lists, must conform to the pattern ^[0-9]{1,19}$.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `id` when calling ListsApi$user_followed_lists, must conform to the pattern ^[0-9]{1,19}$."))
      }

      if (`max_results` > 100) {
        rlang::abort(message = "Invalid value for `max_results` when calling ListsApi$user_followed_lists, must be smaller than or equal to 100.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `max_results` when calling ListsApi$user_followed_lists, must be smaller than or equal to 100."))
      }
      if (`max_results` < 1) {
        rlang::abort(message = "Invalid value for `max_results` when calling ListsApi$user_followed_lists, must be bigger than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `max_results` when calling ListsApi$user_followed_lists, must be bigger than or equal to 1."))
      }

      if (nchar(`pagination_token`) > 19) {
        rlang::abort(message = "Invalid length for `pagination_token` when calling ListsApi$user_followed_lists, must be smaller than or equal to 19.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for $pagination_token when calling ListsApi.user_followed_lists, must be smaller than or equal to 19."))
      }
      if (nchar(`pagination_token`) < 1) {
        rlang::abort(message = "Invalid length for `pagination_token` when calling ListsApi$user_followed_lists, must be bigger than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `pagination_token` when calling ListsApi$user_followed_lists, must be bigger than or equal to 1."))
      }

      if (length(`list_fields`) < 1) {
        rlang::abort(message = "Invalid length for `list_fields` when calling ListsApi$user_followed_lists, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `list_fields` when calling ListsApi$user_followed_lists, number of items must be greater than or equal to 1."))
      }

      if (length(`expansions`) < 1) {
        rlang::abort(message = "Invalid length for `expansions` when calling ListsApi$user_followed_lists, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `expansions` when calling ListsApi$user_followed_lists, number of items must be greater than or equal to 1."))
      }

      if (length(`user_fields`) < 1) {
        rlang::abort(message = "Invalid length for `user_fields` when calling ListsApi$user_followed_lists, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `user_fields` when calling ListsApi$user_followed_lists, number of items must be greater than or equal to 1."))
      }

      query_params[["max_results"]] <- `max_results`

      query_params[["pagination_token"]] <- `pagination_token`

      # check if items are unique
      if (!identical(`list_fields`, unique(`list_fields`))) {
        rlang::abort(message = "Invalid value for `list_fields` when calling ListsApi$user_followed_lists. Items must be unique.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `list_fields` when calling ListsApi$user_followed_lists. Items must be unique."))
      }
      # no explore
      # validate enum values
      for (query_item in `list_fields`) {
        if (!(query_item %in% c("created_at", "description", "follower_count", "id", "member_count", "name", "owner_id", "private"))) {
          rlang::abort(message = "Invalid value for `list_fields` when calling ListsApi$user_followed_lists. Must be [created_at, description, follower_count, id, member_count, name, owner_id, private].",
                       .subclass = "ApiException",
                       ApiException = ApiException$new(status = 0,
                                                       reason = "Invalid value for `list_fields` when calling ListsApi$user_followed_lists. Must be [created_at, description, follower_count, id, member_count, name, owner_id, private]."))
        }
      }
      query_params[["list.fields"]] <- I(paste(lapply(`list_fields`, URLencode, reserved = TRUE), collapse = ","))

      # check if items are unique
      if (!identical(`expansions`, unique(`expansions`))) {
        rlang::abort(message = "Invalid value for `expansions` when calling ListsApi$user_followed_lists. Items must be unique.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `expansions` when calling ListsApi$user_followed_lists. Items must be unique."))
      }
      # no explore
      # validate enum values
      for (query_item in `expansions`) {
        if (!(query_item %in% c("owner_id"))) {
          rlang::abort(message = "Invalid value for `expansions` when calling ListsApi$user_followed_lists. Must be [owner_id].",
                       .subclass = "ApiException",
                       ApiException = ApiException$new(status = 0,
                                                       reason = "Invalid value for `expansions` when calling ListsApi$user_followed_lists. Must be [owner_id]."))
        }
      }
      query_params[["expansions"]] <- I(paste(lapply(`expansions`, URLencode, reserved = TRUE), collapse = ","))

      # check if items are unique
      if (!identical(`user_fields`, unique(`user_fields`))) {
        rlang::abort(message = "Invalid value for `user_fields` when calling ListsApi$user_followed_lists. Items must be unique.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `user_fields` when calling ListsApi$user_followed_lists. Items must be unique."))
      }
      # no explore
      # validate enum values
      for (query_item in `user_fields`) {
        if (!(query_item %in% c("created_at", "description", "entities", "id", "location", "name", "pinned_tweet_id", "profile_image_url", "protected", "public_metrics", "url", "username", "verified", "withheld"))) {
          rlang::abort(message = "Invalid value for `user_fields` when calling ListsApi$user_followed_lists. Must be [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld].",
                       .subclass = "ApiException",
                       ApiException = ApiException$new(status = 0,
                                                       reason = "Invalid value for `user_fields` when calling ListsApi$user_followed_lists. Must be [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld]."))
        }
      }
      query_params[["user.fields"]] <- I(paste(lapply(`user_fields`, URLencode, reserved = TRUE), collapse = ","))

      local_var_url_path <- "/2/users/{id}/followed_lists"
      if (!missing(`id`)) {
        local_var_url_path <- gsub("\\{id\\}", URLencode(as.character(`id`), reserved = TRUE), local_var_url_path)
      }

      # Bearer token
      if (!is.null(self$api_client$bearer_token)) {
        header_params["Authorization"] <- paste("Bearer", self$api_client$bearer_token, sep = " ")
      }
      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read list.read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "Get2UsersIdFollowedListsResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    }
  )
)
