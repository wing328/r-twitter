#' Twitter API v2
#'
#' Twitter API v2 available endpoints
#'
#' The version of the OpenAPI document: 2.49
#' Generated by: https://openapi-generator.tech
#'
#' @docType class
#' @title Spaces operations
#' @description SpacesApi
#' @format An \code{R6Class} generator object
#' @field api_client Handles the client-server communication.
#'
#' @section Methods:
#' \describe{
#' \strong{ find_space_by_id } \emph{ Space lookup by Space ID }
#' Returns a variety of information about the Space specified by the requested ID
#'
#' \itemize{
#' \item \emph{ @param } id character
#' \item \emph{ @param } space_fields Enum < [created_at, creator_id, ended_at, host_ids, id, invited_user_ids, is_ticketed, lang, participant_count, scheduled_start, speaker_ids, started_at, state, subscriber_count, title, topic_ids, updated_at] >
#' \item \emph{ @param } expansions Enum < [creator_id, host_ids, invited_user_ids, speaker_ids, topic_ids] >
#' \item \emph{ @param } user_fields Enum < [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld] >
#' \item \emph{ @param } topic_fields Enum < [description, id, name] >
#' \item \emph{ @returnType } \link{Get2SpacesIdResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : Get2SpacesIdResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ find_spaces_by_creator_ids } \emph{ Space lookup by their creators }
#' Returns a variety of information about the Spaces created by the provided User IDs
#'
#' \itemize{
#' \item \emph{ @param } user_ids list( character )
#' \item \emph{ @param } space_fields Enum < [created_at, creator_id, ended_at, host_ids, id, invited_user_ids, is_ticketed, lang, participant_count, scheduled_start, speaker_ids, started_at, state, subscriber_count, title, topic_ids, updated_at] >
#' \item \emph{ @param } expansions Enum < [creator_id, host_ids, invited_user_ids, speaker_ids, topic_ids] >
#' \item \emph{ @param } user_fields Enum < [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld] >
#' \item \emph{ @param } topic_fields Enum < [description, id, name] >
#' \item \emph{ @returnType } \link{Get2SpacesByCreatorIdsResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : Get2SpacesByCreatorIdsResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ find_spaces_by_ids } \emph{ Space lookup up Space IDs }
#' Returns a variety of information about the Spaces specified by the requested IDs
#'
#' \itemize{
#' \item \emph{ @param } ids list( character )
#' \item \emph{ @param } space_fields Enum < [created_at, creator_id, ended_at, host_ids, id, invited_user_ids, is_ticketed, lang, participant_count, scheduled_start, speaker_ids, started_at, state, subscriber_count, title, topic_ids, updated_at] >
#' \item \emph{ @param } expansions Enum < [creator_id, host_ids, invited_user_ids, speaker_ids, topic_ids] >
#' \item \emph{ @param } user_fields Enum < [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld] >
#' \item \emph{ @param } topic_fields Enum < [description, id, name] >
#' \item \emph{ @returnType } \link{Get2SpacesResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : Get2SpacesResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ search_spaces } \emph{ Search for Spaces }
#' Returns Spaces that match the provided query.
#'
#' \itemize{
#' \item \emph{ @param } query character
#' \item \emph{ @param } state Enum < [live, scheduled, all] >
#' \item \emph{ @param } max_results integer
#' \item \emph{ @param } space_fields Enum < [created_at, creator_id, ended_at, host_ids, id, invited_user_ids, is_ticketed, lang, participant_count, scheduled_start, speaker_ids, started_at, state, subscriber_count, title, topic_ids, updated_at] >
#' \item \emph{ @param } expansions Enum < [creator_id, host_ids, invited_user_ids, speaker_ids, topic_ids] >
#' \item \emph{ @param } user_fields Enum < [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld] >
#' \item \emph{ @param } topic_fields Enum < [description, id, name] >
#' \item \emph{ @returnType } \link{Get2SpacesSearchResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : Get2SpacesSearchResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ space_buyers } \emph{ Retrieve the list of Users who purchased a ticket to the given space }
#' Retrieves the list of Users who purchased a ticket to the given space
#'
#' \itemize{
#' \item \emph{ @param } id character
#' \item \emph{ @param } pagination_token character
#' \item \emph{ @param } max_results integer
#' \item \emph{ @param } user_fields Enum < [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld] >
#' \item \emph{ @param } expansions Enum < [pinned_tweet_id] >
#' \item \emph{ @param } tweet_fields Enum < [attachments, author_id, context_annotations, conversation_id, created_at, entities, geo, id, in_reply_to_user_id, lang, non_public_metrics, organic_metrics, possibly_sensitive, promoted_metrics, public_metrics, referenced_tweets, reply_settings, source, text, withheld] >
#' \item \emph{ @returnType } \link{Get2SpacesIdBuyersResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : Get2SpacesIdBuyersResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' \strong{ space_tweets } \emph{ Retrieve Tweets from a Space. }
#' Retrieves Tweets shared in the specified Space.
#'
#' \itemize{
#' \item \emph{ @param } id character
#' \item \emph{ @param } max_results integer
#' \item \emph{ @param } tweet_fields Enum < [attachments, author_id, context_annotations, conversation_id, created_at, entities, geo, id, in_reply_to_user_id, lang, non_public_metrics, organic_metrics, possibly_sensitive, promoted_metrics, public_metrics, referenced_tweets, reply_settings, source, text, withheld] >
#' \item \emph{ @param } expansions Enum < [attachments.media_keys, attachments.poll_ids, author_id, entities.mentions.username, geo.place_id, in_reply_to_user_id, referenced_tweets.id, referenced_tweets.id.author_id] >
#' \item \emph{ @param } media_fields Enum < [alt_text, duration_ms, height, media_key, non_public_metrics, organic_metrics, preview_image_url, promoted_metrics, public_metrics, type, url, variants, width] >
#' \item \emph{ @param } poll_fields Enum < [duration_minutes, end_datetime, id, options, voting_status] >
#' \item \emph{ @param } user_fields Enum < [created_at, description, entities, id, location, name, pinned_tweet_id, profile_image_url, protected, public_metrics, url, username, verified, withheld] >
#' \item \emph{ @param } place_fields Enum < [contained_within, country, country_code, full_name, geo, id, name, place_type] >
#' \item \emph{ @returnType } \link{Get2SpacesIdTweetsResponse} \cr
#'
#' \item On encountering errors, an error of subclass ApiException will be thrown.
#'
#' \item status code : 200 | The request has succeeded.
#'
#' \item return type : Get2SpacesIdTweetsResponse
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' \item status code : 0 | The request has failed.
#'
#' \item return type : Error
#' \item response headers :
#'
#' \tabular{ll}{
#' }
#' }
#'
#' }
#'
#'
#' @examples
#' \dontrun{
#' ####################  find_space_by_id  ####################
#'
#' library(twitter)
#' var_id <- "1YqKDqWqdPLsV" # character | The ID of the Space to be retrieved.
#' var_space_fields <- ["[\"created_at\",\"creator_id\",\"ended_at\",\"host_ids\",\"id\",\"invited_user_ids\",\"is_ticketed\",\"lang\",\"participant_count\",\"scheduled_start\",\"speaker_ids\",\"started_at\",\"state\",\"subscriber_count\",\"title\",\"topic_ids\",\"updated_at\"]"] # set[character] | A comma separated list of Space fields to display.
#' var_expansions <- ["[\"creator_id\",\"host_ids\",\"invited_user_ids\",\"speaker_ids\",\"topic_ids\"]"] # set[character] | A comma separated list of fields to expand.
#' var_user_fields <- ["[\"created_at\",\"description\",\"entities\",\"id\",\"location\",\"name\",\"pinned_tweet_id\",\"profile_image_url\",\"protected\",\"public_metrics\",\"url\",\"username\",\"verified\",\"withheld\"]"] # set[character] | A comma separated list of User fields to display.
#' var_topic_fields <- ["[\"description\",\"id\",\"name\"]"] # set[character] | A comma separated list of Topic fields to display.
#'
#' #Space lookup by Space ID
#' api_instance <- twitter_api$new()
#'
#' # Configure HTTP bearer authorization: BearerToken
#' api_instance$api_client$bearer_token <- Sys.getenv("BEARER_TOKEN")
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$spaces_api$find_space_by_id(var_id, space_fields = var_space_fields, expansions = var_expansions, user_fields = var_user_fields, topic_fields = var_topic_fields, data_file = "result.txt"),
#'              
#'              
#'              api_instance$spaces_api$find_space_by_id(var_id, space_fields = var_space_fields, expansions = var_expansions, user_fields = var_user_fields, topic_fields = var_topic_fields),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `find_space_by_id`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' ####################  find_spaces_by_creator_ids  ####################
#'
#' library(twitter)
#' var_user_ids <- ["user_ids_example"] # array[character] | The IDs of Users to search through.
#' var_space_fields <- ["[\"created_at\",\"creator_id\",\"ended_at\",\"host_ids\",\"id\",\"invited_user_ids\",\"is_ticketed\",\"lang\",\"participant_count\",\"scheduled_start\",\"speaker_ids\",\"started_at\",\"state\",\"subscriber_count\",\"title\",\"topic_ids\",\"updated_at\"]"] # set[character] | A comma separated list of Space fields to display.
#' var_expansions <- ["[\"creator_id\",\"host_ids\",\"invited_user_ids\",\"speaker_ids\",\"topic_ids\"]"] # set[character] | A comma separated list of fields to expand.
#' var_user_fields <- ["[\"created_at\",\"description\",\"entities\",\"id\",\"location\",\"name\",\"pinned_tweet_id\",\"profile_image_url\",\"protected\",\"public_metrics\",\"url\",\"username\",\"verified\",\"withheld\"]"] # set[character] | A comma separated list of User fields to display.
#' var_topic_fields <- ["[\"description\",\"id\",\"name\"]"] # set[character] | A comma separated list of Topic fields to display.
#'
#' #Space lookup by their creators
#' api_instance <- twitter_api$new()
#'
#' # Configure HTTP bearer authorization: BearerToken
#' api_instance$api_client$bearer_token <- Sys.getenv("BEARER_TOKEN")
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$spaces_api$find_spaces_by_creator_ids(var_user_ids, space_fields = var_space_fields, expansions = var_expansions, user_fields = var_user_fields, topic_fields = var_topic_fields, data_file = "result.txt"),
#'              
#'              
#'              api_instance$spaces_api$find_spaces_by_creator_ids(var_user_ids, space_fields = var_space_fields, expansions = var_expansions, user_fields = var_user_fields, topic_fields = var_topic_fields),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `find_spaces_by_creator_ids`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' ####################  find_spaces_by_ids  ####################
#'
#' library(twitter)
#' var_ids <- ["ids_example"] # array[character] | The list of Space IDs to return.
#' var_space_fields <- ["[\"created_at\",\"creator_id\",\"ended_at\",\"host_ids\",\"id\",\"invited_user_ids\",\"is_ticketed\",\"lang\",\"participant_count\",\"scheduled_start\",\"speaker_ids\",\"started_at\",\"state\",\"subscriber_count\",\"title\",\"topic_ids\",\"updated_at\"]"] # set[character] | A comma separated list of Space fields to display.
#' var_expansions <- ["[\"creator_id\",\"host_ids\",\"invited_user_ids\",\"speaker_ids\",\"topic_ids\"]"] # set[character] | A comma separated list of fields to expand.
#' var_user_fields <- ["[\"created_at\",\"description\",\"entities\",\"id\",\"location\",\"name\",\"pinned_tweet_id\",\"profile_image_url\",\"protected\",\"public_metrics\",\"url\",\"username\",\"verified\",\"withheld\"]"] # set[character] | A comma separated list of User fields to display.
#' var_topic_fields <- ["[\"description\",\"id\",\"name\"]"] # set[character] | A comma separated list of Topic fields to display.
#'
#' #Space lookup up Space IDs
#' api_instance <- twitter_api$new()
#'
#' # Configure HTTP bearer authorization: BearerToken
#' api_instance$api_client$bearer_token <- Sys.getenv("BEARER_TOKEN")
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$spaces_api$find_spaces_by_ids(var_ids, space_fields = var_space_fields, expansions = var_expansions, user_fields = var_user_fields, topic_fields = var_topic_fields, data_file = "result.txt"),
#'              
#'              
#'              api_instance$spaces_api$find_spaces_by_ids(var_ids, space_fields = var_space_fields, expansions = var_expansions, user_fields = var_user_fields, topic_fields = var_topic_fields),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `find_spaces_by_ids`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' ####################  search_spaces  ####################
#'
#' library(twitter)
#' var_query <- "crypto" # character | The search query.
#' var_state <- "all" # character | The state of Spaces to search for.
#' var_max_results <- 100 # integer | The number of results to return.
#' var_space_fields <- ["[\"created_at\",\"creator_id\",\"ended_at\",\"host_ids\",\"id\",\"invited_user_ids\",\"is_ticketed\",\"lang\",\"participant_count\",\"scheduled_start\",\"speaker_ids\",\"started_at\",\"state\",\"subscriber_count\",\"title\",\"topic_ids\",\"updated_at\"]"] # set[character] | A comma separated list of Space fields to display.
#' var_expansions <- ["[\"creator_id\",\"host_ids\",\"invited_user_ids\",\"speaker_ids\",\"topic_ids\"]"] # set[character] | A comma separated list of fields to expand.
#' var_user_fields <- ["[\"created_at\",\"description\",\"entities\",\"id\",\"location\",\"name\",\"pinned_tweet_id\",\"profile_image_url\",\"protected\",\"public_metrics\",\"url\",\"username\",\"verified\",\"withheld\"]"] # set[character] | A comma separated list of User fields to display.
#' var_topic_fields <- ["[\"description\",\"id\",\"name\"]"] # set[character] | A comma separated list of Topic fields to display.
#'
#' #Search for Spaces
#' api_instance <- twitter_api$new()
#'
#' # Configure HTTP bearer authorization: BearerToken
#' api_instance$api_client$bearer_token <- Sys.getenv("BEARER_TOKEN")
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$spaces_api$search_spaces(var_query, state = var_state, max_results = var_max_results, space_fields = var_space_fields, expansions = var_expansions, user_fields = var_user_fields, topic_fields = var_topic_fields, data_file = "result.txt"),
#'              
#'              
#'              api_instance$spaces_api$search_spaces(var_query, state = var_state, max_results = var_max_results, space_fields = var_space_fields, expansions = var_expansions, user_fields = var_user_fields, topic_fields = var_topic_fields),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `search_spaces`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' ####################  space_buyers  ####################
#'
#' library(twitter)
#' var_id <- "1YqKDqWqdPLsV" # character | The ID of the Space to be retrieved.
#' var_pagination_token <- "pagination_token_example" # character | This parameter is used to get a specified 'page' of results.
#' var_max_results <- 100 # integer | The maximum number of results.
#' var_user_fields <- ["[\"created_at\",\"description\",\"entities\",\"id\",\"location\",\"name\",\"pinned_tweet_id\",\"profile_image_url\",\"protected\",\"public_metrics\",\"url\",\"username\",\"verified\",\"withheld\"]"] # set[character] | A comma separated list of User fields to display.
#' var_expansions <- ["[\"pinned_tweet_id\"]"] # set[character] | A comma separated list of fields to expand.
#' var_tweet_fields <- ["[\"attachments\",\"author_id\",\"context_annotations\",\"conversation_id\",\"created_at\",\"entities\",\"geo\",\"id\",\"in_reply_to_user_id\",\"lang\",\"non_public_metrics\",\"organic_metrics\",\"possibly_sensitive\",\"promoted_metrics\",\"public_metrics\",\"referenced_tweets\",\"reply_settings\",\"source\",\"text\",\"withheld\"]"] # set[character] | A comma separated list of Tweet fields to display.
#'
#' #Retrieve the list of Users who purchased a ticket to the given space
#' api_instance <- twitter_api$new()
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$spaces_api$space_buyers(var_id, pagination_token = var_pagination_token, max_results = var_max_results, user_fields = var_user_fields, expansions = var_expansions, tweet_fields = var_tweet_fields, data_file = "result.txt"),
#'              
#'              
#'              api_instance$spaces_api$space_buyers(var_id, pagination_token = var_pagination_token, max_results = var_max_results, user_fields = var_user_fields, expansions = var_expansions, tweet_fields = var_tweet_fields),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `space_buyers`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' ####################  space_tweets  ####################
#'
#' library(twitter)
#' var_id <- "1YqKDqWqdPLsV" # character | The ID of the Space to be retrieved.
#' var_max_results <- 100 # integer | The number of Tweets to fetch from the provided space. If not provided, the value will default to the maximum of 100.
#' var_tweet_fields <- ["[\"attachments\",\"author_id\",\"context_annotations\",\"conversation_id\",\"created_at\",\"entities\",\"geo\",\"id\",\"in_reply_to_user_id\",\"lang\",\"non_public_metrics\",\"organic_metrics\",\"possibly_sensitive\",\"promoted_metrics\",\"public_metrics\",\"referenced_tweets\",\"reply_settings\",\"source\",\"text\",\"withheld\"]"] # set[character] | A comma separated list of Tweet fields to display.
#' var_expansions <- ["[\"attachments.media_keys\",\"attachments.poll_ids\",\"author_id\",\"entities.mentions.username\",\"geo.place_id\",\"in_reply_to_user_id\",\"referenced_tweets.id\",\"referenced_tweets.id.author_id\"]"] # set[character] | A comma separated list of fields to expand.
#' var_media_fields <- ["[\"alt_text\",\"duration_ms\",\"height\",\"media_key\",\"non_public_metrics\",\"organic_metrics\",\"preview_image_url\",\"promoted_metrics\",\"public_metrics\",\"type\",\"url\",\"variants\",\"width\"]"] # set[character] | A comma separated list of Media fields to display.
#' var_poll_fields <- ["[\"duration_minutes\",\"end_datetime\",\"id\",\"options\",\"voting_status\"]"] # set[character] | A comma separated list of Poll fields to display.
#' var_user_fields <- ["[\"created_at\",\"description\",\"entities\",\"id\",\"location\",\"name\",\"pinned_tweet_id\",\"profile_image_url\",\"protected\",\"public_metrics\",\"url\",\"username\",\"verified\",\"withheld\"]"] # set[character] | A comma separated list of User fields to display.
#' var_place_fields <- ["[\"contained_within\",\"country\",\"country_code\",\"full_name\",\"geo\",\"id\",\"name\",\"place_type\"]"] # set[character] | A comma separated list of Place fields to display.
#'
#' #Retrieve Tweets from a Space.
#' api_instance <- twitter_api$new()
#'
#' # Configure HTTP bearer authorization: BearerToken
#' api_instance$api_client$bearer_token <- Sys.getenv("BEARER_TOKEN")
#'
#' # Configure OAuth2 access token for authorization: OAuth2UserToken
#' api_instance$api_client$access_token <- Sys.getenv("ACCESS_TOKEN")
#'
#' result <- tryCatch(
#'              
#'              # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#'              # api_instance$spaces_api$space_tweets(var_id, max_results = var_max_results, tweet_fields = var_tweet_fields, expansions = var_expansions, media_fields = var_media_fields, poll_fields = var_poll_fields, user_fields = var_user_fields, place_fields = var_place_fields, data_file = "result.txt"),
#'              
#'              
#'              api_instance$spaces_api$space_tweets(var_id, max_results = var_max_results, tweet_fields = var_tweet_fields, expansions = var_expansions, media_fields = var_media_fields, poll_fields = var_poll_fields, user_fields = var_user_fields, place_fields = var_place_fields),
#'              ApiException = function(ex) ex
#'           )
#' # In case of error, print the error object
#' if (!is.null(result$ApiException)) {
#'   print("Exception occurs when calling `space_tweets`:")
#'   dput(result$ApiException$toString())
#'   
#'   # error object
#'   dput(result$ApiException$error_object$toJSONString())
#'   
#' } else {
#'   # deserialized response object
#'   print("The response is ...")
#'   dput(result$toString())
#' }
#'
#'
#'
#' }
#' @importFrom R6 R6Class
#' @importFrom base64enc base64encode
#' @importFrom rlang abort
#' @export
SpacesApi <- R6::R6Class(
  "SpacesApi",
  public = list(
    api_client = NULL,
    #' Initialize a new SpacesApi.
    #'
    #' @description
    #' Initialize a new SpacesApi.
    #'
    #' @param api_client An instance of API client.
    #' @export
    initialize = function(api_client) {
      if (!missing(api_client)) {
        self$api_client <- api_client
      } else {
        self$api_client <- ApiClient$new()
      }
    },
    #' Space lookup by Space ID
    #'
    #' @description
    #' Space lookup by Space ID
    #'
    #' @param id The ID of the Space to be retrieved.
    #' @param space_fields (optional) A comma separated list of Space fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param topic_fields (optional) A comma separated list of Topic fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return Get2SpacesIdResponse
    #' @export
    find_space_by_id = function(id, space_fields = NULL, expansions = NULL, user_fields = NULL, topic_fields = NULL, data_file = NULL, ...) {
      local_var_response <- self$find_space_by_id_with_http_info(id, space_fields, expansions, user_fields, topic_fields, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Space lookup by Space ID
    #'
    #' @description
    #' Space lookup by Space ID
    #'
    #' @param id The ID of the Space to be retrieved.
    #' @param space_fields (optional) A comma separated list of Space fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param topic_fields (optional) A comma separated list of Topic fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (Get2SpacesIdResponse) with additional information such as HTTP status code, headers
    #' @export
    find_space_by_id_with_http_info = function(id, space_fields = NULL, expansions = NULL, user_fields = NULL, topic_fields = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`id`)) {
        rlang::abort(message = "Missing required parameter `id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `id`."))
      }

      if (!str_detect(`id`, "^[a-zA-Z0-9]{1,13}$")) {
        rlang::abort(message = "Invalid value for `id` when calling SpacesApi$find_space_by_id, must conform to the pattern ^[a-zA-Z0-9]{1,13}$.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `id` when calling SpacesApi$find_space_by_id, must conform to the pattern ^[a-zA-Z0-9]{1,13}$."))
      }

      if (length(`space_fields`) < 1) {
        rlang::abort(message = "Invalid length for `space_fields` when calling SpacesApi$find_space_by_id, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `space_fields` when calling SpacesApi$find_space_by_id, number of items must be greater than or equal to 1."))
      }

      if (length(`expansions`) < 1) {
        rlang::abort(message = "Invalid length for `expansions` when calling SpacesApi$find_space_by_id, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `expansions` when calling SpacesApi$find_space_by_id, number of items must be greater than or equal to 1."))
      }

      if (length(`user_fields`) < 1) {
        rlang::abort(message = "Invalid length for `user_fields` when calling SpacesApi$find_space_by_id, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `user_fields` when calling SpacesApi$find_space_by_id, number of items must be greater than or equal to 1."))
      }

      if (length(`topic_fields`) < 1) {
        rlang::abort(message = "Invalid length for `topic_fields` when calling SpacesApi$find_space_by_id, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `topic_fields` when calling SpacesApi$find_space_by_id, number of items must be greater than or equal to 1."))
      }

      for (query_item in `space_fields`) {
        query_params[["space.fields"]] <- c(query_params[["space.fields"]], list(`space.fields` = query_item))
      }

      for (query_item in `expansions`) {
        query_params[["expansions"]] <- c(query_params[["expansions"]], list(`expansions` = query_item))
      }

      for (query_item in `user_fields`) {
        query_params[["user.fields"]] <- c(query_params[["user.fields"]], list(`user.fields` = query_item))
      }

      for (query_item in `topic_fields`) {
        query_params[["topic.fields"]] <- c(query_params[["topic.fields"]], list(`topic.fields` = query_item))
      }

      local_var_url_path <- "/2/spaces/{id}"
      if (!missing(`id`)) {
        local_var_url_path <- gsub(paste0("\\{", "id", "\\}"), URLencode(as.character(`id`), reserved = TRUE), local_var_url_path)
      }

      # Bearer token
      if (!is.null(self$api_client$bearer_token)) {
        header_params["Authorization"] <- paste("Bearer", self$api_client$bearer_token, sep = " ")
      }
      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read space.read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "Get2SpacesIdResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    },
    #' Space lookup by their creators
    #'
    #' @description
    #' Space lookup by their creators
    #'
    #' @param user_ids The IDs of Users to search through.
    #' @param space_fields (optional) A comma separated list of Space fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param topic_fields (optional) A comma separated list of Topic fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return Get2SpacesByCreatorIdsResponse
    #' @export
    find_spaces_by_creator_ids = function(user_ids, space_fields = NULL, expansions = NULL, user_fields = NULL, topic_fields = NULL, data_file = NULL, ...) {
      local_var_response <- self$find_spaces_by_creator_ids_with_http_info(user_ids, space_fields, expansions, user_fields, topic_fields, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Space lookup by their creators
    #'
    #' @description
    #' Space lookup by their creators
    #'
    #' @param user_ids The IDs of Users to search through.
    #' @param space_fields (optional) A comma separated list of Space fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param topic_fields (optional) A comma separated list of Topic fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (Get2SpacesByCreatorIdsResponse) with additional information such as HTTP status code, headers
    #' @export
    find_spaces_by_creator_ids_with_http_info = function(user_ids, space_fields = NULL, expansions = NULL, user_fields = NULL, topic_fields = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`user_ids`)) {
        rlang::abort(message = "Missing required parameter `user_ids`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `user_ids`."))
      }

      if (length(`user_ids`) > 100) {
        rlang::abort(message = "Invalid length for `user_ids` when calling SpacesApi$find_spaces_by_creator_ids, number of items must be less than or equal to 100.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `user_ids` when calling SpacesApi$find_spaces_by_creator_ids, number of items must be less than or equal to 100."))
      }
      if (length(`user_ids`) < 1) {
        rlang::abort(message = "Invalid length for `user_ids` when calling SpacesApi$find_spaces_by_creator_ids, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `user_ids` when calling SpacesApi$find_spaces_by_creator_ids, number of items must be greater than or equal to 1."))
      }

      if (length(`space_fields`) < 1) {
        rlang::abort(message = "Invalid length for `space_fields` when calling SpacesApi$find_spaces_by_creator_ids, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `space_fields` when calling SpacesApi$find_spaces_by_creator_ids, number of items must be greater than or equal to 1."))
      }

      if (length(`expansions`) < 1) {
        rlang::abort(message = "Invalid length for `expansions` when calling SpacesApi$find_spaces_by_creator_ids, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `expansions` when calling SpacesApi$find_spaces_by_creator_ids, number of items must be greater than or equal to 1."))
      }

      if (length(`user_fields`) < 1) {
        rlang::abort(message = "Invalid length for `user_fields` when calling SpacesApi$find_spaces_by_creator_ids, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `user_fields` when calling SpacesApi$find_spaces_by_creator_ids, number of items must be greater than or equal to 1."))
      }

      if (length(`topic_fields`) < 1) {
        rlang::abort(message = "Invalid length for `topic_fields` when calling SpacesApi$find_spaces_by_creator_ids, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `topic_fields` when calling SpacesApi$find_spaces_by_creator_ids, number of items must be greater than or equal to 1."))
      }

      for (query_item in `user_ids`) {
        query_params[["user_ids"]] <- c(query_params[["user_ids"]], list(`user_ids` = query_item))
      }

      for (query_item in `space_fields`) {
        query_params[["space.fields"]] <- c(query_params[["space.fields"]], list(`space.fields` = query_item))
      }

      for (query_item in `expansions`) {
        query_params[["expansions"]] <- c(query_params[["expansions"]], list(`expansions` = query_item))
      }

      for (query_item in `user_fields`) {
        query_params[["user.fields"]] <- c(query_params[["user.fields"]], list(`user.fields` = query_item))
      }

      for (query_item in `topic_fields`) {
        query_params[["topic.fields"]] <- c(query_params[["topic.fields"]], list(`topic.fields` = query_item))
      }

      local_var_url_path <- "/2/spaces/by/creator_ids"
      # Bearer token
      if (!is.null(self$api_client$bearer_token)) {
        header_params["Authorization"] <- paste("Bearer", self$api_client$bearer_token, sep = " ")
      }
      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read space.read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "Get2SpacesByCreatorIdsResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    },
    #' Space lookup up Space IDs
    #'
    #' @description
    #' Space lookup up Space IDs
    #'
    #' @param ids The list of Space IDs to return.
    #' @param space_fields (optional) A comma separated list of Space fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param topic_fields (optional) A comma separated list of Topic fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return Get2SpacesResponse
    #' @export
    find_spaces_by_ids = function(ids, space_fields = NULL, expansions = NULL, user_fields = NULL, topic_fields = NULL, data_file = NULL, ...) {
      local_var_response <- self$find_spaces_by_ids_with_http_info(ids, space_fields, expansions, user_fields, topic_fields, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Space lookup up Space IDs
    #'
    #' @description
    #' Space lookup up Space IDs
    #'
    #' @param ids The list of Space IDs to return.
    #' @param space_fields (optional) A comma separated list of Space fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param topic_fields (optional) A comma separated list of Topic fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (Get2SpacesResponse) with additional information such as HTTP status code, headers
    #' @export
    find_spaces_by_ids_with_http_info = function(ids, space_fields = NULL, expansions = NULL, user_fields = NULL, topic_fields = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`ids`)) {
        rlang::abort(message = "Missing required parameter `ids`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `ids`."))
      }

      if (length(`ids`) > 100) {
        rlang::abort(message = "Invalid length for `ids` when calling SpacesApi$find_spaces_by_ids, number of items must be less than or equal to 100.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `ids` when calling SpacesApi$find_spaces_by_ids, number of items must be less than or equal to 100."))
      }
      if (length(`ids`) < 1) {
        rlang::abort(message = "Invalid length for `ids` when calling SpacesApi$find_spaces_by_ids, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `ids` when calling SpacesApi$find_spaces_by_ids, number of items must be greater than or equal to 1."))
      }

      if (length(`space_fields`) < 1) {
        rlang::abort(message = "Invalid length for `space_fields` when calling SpacesApi$find_spaces_by_ids, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `space_fields` when calling SpacesApi$find_spaces_by_ids, number of items must be greater than or equal to 1."))
      }

      if (length(`expansions`) < 1) {
        rlang::abort(message = "Invalid length for `expansions` when calling SpacesApi$find_spaces_by_ids, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `expansions` when calling SpacesApi$find_spaces_by_ids, number of items must be greater than or equal to 1."))
      }

      if (length(`user_fields`) < 1) {
        rlang::abort(message = "Invalid length for `user_fields` when calling SpacesApi$find_spaces_by_ids, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `user_fields` when calling SpacesApi$find_spaces_by_ids, number of items must be greater than or equal to 1."))
      }

      if (length(`topic_fields`) < 1) {
        rlang::abort(message = "Invalid length for `topic_fields` when calling SpacesApi$find_spaces_by_ids, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `topic_fields` when calling SpacesApi$find_spaces_by_ids, number of items must be greater than or equal to 1."))
      }

      for (query_item in `ids`) {
        query_params[["ids"]] <- c(query_params[["ids"]], list(`ids` = query_item))
      }

      for (query_item in `space_fields`) {
        query_params[["space.fields"]] <- c(query_params[["space.fields"]], list(`space.fields` = query_item))
      }

      for (query_item in `expansions`) {
        query_params[["expansions"]] <- c(query_params[["expansions"]], list(`expansions` = query_item))
      }

      for (query_item in `user_fields`) {
        query_params[["user.fields"]] <- c(query_params[["user.fields"]], list(`user.fields` = query_item))
      }

      for (query_item in `topic_fields`) {
        query_params[["topic.fields"]] <- c(query_params[["topic.fields"]], list(`topic.fields` = query_item))
      }

      local_var_url_path <- "/2/spaces"
      # Bearer token
      if (!is.null(self$api_client$bearer_token)) {
        header_params["Authorization"] <- paste("Bearer", self$api_client$bearer_token, sep = " ")
      }
      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read space.read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "Get2SpacesResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    },
    #' Search for Spaces
    #'
    #' @description
    #' Search for Spaces
    #'
    #' @param query The search query.
    #' @param state (optional) The state of Spaces to search for. (default value: "all")
    #' @param max_results (optional) The number of results to return. (default value: 100)
    #' @param space_fields (optional) A comma separated list of Space fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param topic_fields (optional) A comma separated list of Topic fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return Get2SpacesSearchResponse
    #' @export
    search_spaces = function(query, state = "all", max_results = 100, space_fields = NULL, expansions = NULL, user_fields = NULL, topic_fields = NULL, data_file = NULL, ...) {
      local_var_response <- self$search_spaces_with_http_info(query, state, max_results, space_fields, expansions, user_fields, topic_fields, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Search for Spaces
    #'
    #' @description
    #' Search for Spaces
    #'
    #' @param query The search query.
    #' @param state (optional) The state of Spaces to search for. (default value: "all")
    #' @param max_results (optional) The number of results to return. (default value: 100)
    #' @param space_fields (optional) A comma separated list of Space fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param topic_fields (optional) A comma separated list of Topic fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (Get2SpacesSearchResponse) with additional information such as HTTP status code, headers
    #' @export
    search_spaces_with_http_info = function(query, state = "all", max_results = 100, space_fields = NULL, expansions = NULL, user_fields = NULL, topic_fields = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`query`)) {
        rlang::abort(message = "Missing required parameter `query`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `query`."))
      }

      if (nchar(`query`) > 2048) {
        rlang::abort(message = "Invalid length for `query` when calling SpacesApi$search_spaces, must be smaller than or equal to 2048.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for $query when calling SpacesApi.search_spaces, must be smaller than or equal to 2048."))
      }
      if (nchar(`query`) < 1) {
        rlang::abort(message = "Invalid length for `query` when calling SpacesApi$search_spaces, must be bigger than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `query` when calling SpacesApi$search_spaces, must be bigger than or equal to 1."))
      }


      if (`max_results` > 100) {
        rlang::abort(message = "Invalid value for `max_results` when calling SpacesApi$search_spaces, must be smaller than or equal to 100.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `max_results` when calling SpacesApi$search_spaces, must be smaller than or equal to 100."))
      }
      if (`max_results` < 1) {
        rlang::abort(message = "Invalid value for `max_results` when calling SpacesApi$search_spaces, must be bigger than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `max_results` when calling SpacesApi$search_spaces, must be bigger than or equal to 1."))
      }

      if (length(`space_fields`) < 1) {
        rlang::abort(message = "Invalid length for `space_fields` when calling SpacesApi$search_spaces, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `space_fields` when calling SpacesApi$search_spaces, number of items must be greater than or equal to 1."))
      }

      if (length(`expansions`) < 1) {
        rlang::abort(message = "Invalid length for `expansions` when calling SpacesApi$search_spaces, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `expansions` when calling SpacesApi$search_spaces, number of items must be greater than or equal to 1."))
      }

      if (length(`user_fields`) < 1) {
        rlang::abort(message = "Invalid length for `user_fields` when calling SpacesApi$search_spaces, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `user_fields` when calling SpacesApi$search_spaces, number of items must be greater than or equal to 1."))
      }

      if (length(`topic_fields`) < 1) {
        rlang::abort(message = "Invalid length for `topic_fields` when calling SpacesApi$search_spaces, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `topic_fields` when calling SpacesApi$search_spaces, number of items must be greater than or equal to 1."))
      }

      query_params["query"] <- `query`

      query_params["state"] <- `state`

      query_params["max_results"] <- `max_results`

      for (query_item in `space_fields`) {
        query_params[["space.fields"]] <- c(query_params[["space.fields"]], list(`space.fields` = query_item))
      }

      for (query_item in `expansions`) {
        query_params[["expansions"]] <- c(query_params[["expansions"]], list(`expansions` = query_item))
      }

      for (query_item in `user_fields`) {
        query_params[["user.fields"]] <- c(query_params[["user.fields"]], list(`user.fields` = query_item))
      }

      for (query_item in `topic_fields`) {
        query_params[["topic.fields"]] <- c(query_params[["topic.fields"]], list(`topic.fields` = query_item))
      }

      local_var_url_path <- "/2/spaces/search"
      # Bearer token
      if (!is.null(self$api_client$bearer_token)) {
        header_params["Authorization"] <- paste("Bearer", self$api_client$bearer_token, sep = " ")
      }
      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read space.read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "Get2SpacesSearchResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    },
    #' Retrieve the list of Users who purchased a ticket to the given space
    #'
    #' @description
    #' Retrieve the list of Users who purchased a ticket to the given space
    #'
    #' @param id The ID of the Space to be retrieved.
    #' @param pagination_token (optional) This parameter is used to get a specified 'page' of results.
    #' @param max_results (optional) The maximum number of results. (default value: 100)
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param tweet_fields (optional) A comma separated list of Tweet fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return Get2SpacesIdBuyersResponse
    #' @export
    space_buyers = function(id, pagination_token = NULL, max_results = 100, user_fields = NULL, expansions = NULL, tweet_fields = NULL, data_file = NULL, ...) {
      local_var_response <- self$space_buyers_with_http_info(id, pagination_token, max_results, user_fields, expansions, tweet_fields, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Retrieve the list of Users who purchased a ticket to the given space
    #'
    #' @description
    #' Retrieve the list of Users who purchased a ticket to the given space
    #'
    #' @param id The ID of the Space to be retrieved.
    #' @param pagination_token (optional) This parameter is used to get a specified 'page' of results.
    #' @param max_results (optional) The maximum number of results. (default value: 100)
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param tweet_fields (optional) A comma separated list of Tweet fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (Get2SpacesIdBuyersResponse) with additional information such as HTTP status code, headers
    #' @export
    space_buyers_with_http_info = function(id, pagination_token = NULL, max_results = 100, user_fields = NULL, expansions = NULL, tweet_fields = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`id`)) {
        rlang::abort(message = "Missing required parameter `id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `id`."))
      }

      if (!str_detect(`id`, "^[a-zA-Z0-9]{1,13}$")) {
        rlang::abort(message = "Invalid value for `id` when calling SpacesApi$space_buyers, must conform to the pattern ^[a-zA-Z0-9]{1,13}$.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `id` when calling SpacesApi$space_buyers, must conform to the pattern ^[a-zA-Z0-9]{1,13}$."))
      }

      if (nchar(`pagination_token`) < 16) {
        rlang::abort(message = "Invalid length for `pagination_token` when calling SpacesApi$space_buyers, must be bigger than or equal to 16.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `pagination_token` when calling SpacesApi$space_buyers, must be bigger than or equal to 16."))
      }

      if (`max_results` > 100) {
        rlang::abort(message = "Invalid value for `max_results` when calling SpacesApi$space_buyers, must be smaller than or equal to 100.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `max_results` when calling SpacesApi$space_buyers, must be smaller than or equal to 100."))
      }
      if (`max_results` < 1) {
        rlang::abort(message = "Invalid value for `max_results` when calling SpacesApi$space_buyers, must be bigger than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `max_results` when calling SpacesApi$space_buyers, must be bigger than or equal to 1."))
      }

      if (length(`user_fields`) < 1) {
        rlang::abort(message = "Invalid length for `user_fields` when calling SpacesApi$space_buyers, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `user_fields` when calling SpacesApi$space_buyers, number of items must be greater than or equal to 1."))
      }

      if (length(`expansions`) < 1) {
        rlang::abort(message = "Invalid length for `expansions` when calling SpacesApi$space_buyers, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `expansions` when calling SpacesApi$space_buyers, number of items must be greater than or equal to 1."))
      }

      if (length(`tweet_fields`) < 1) {
        rlang::abort(message = "Invalid length for `tweet_fields` when calling SpacesApi$space_buyers, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `tweet_fields` when calling SpacesApi$space_buyers, number of items must be greater than or equal to 1."))
      }

      query_params["pagination_token"] <- `pagination_token`

      query_params["max_results"] <- `max_results`

      for (query_item in `user_fields`) {
        query_params[["user.fields"]] <- c(query_params[["user.fields"]], list(`user.fields` = query_item))
      }

      for (query_item in `expansions`) {
        query_params[["expansions"]] <- c(query_params[["expansions"]], list(`expansions` = query_item))
      }

      for (query_item in `tweet_fields`) {
        query_params[["tweet.fields"]] <- c(query_params[["tweet.fields"]], list(`tweet.fields` = query_item))
      }

      local_var_url_path <- "/2/spaces/{id}/buyers"
      if (!missing(`id`)) {
        local_var_url_path <- gsub(paste0("\\{", "id", "\\}"), URLencode(as.character(`id`), reserved = TRUE), local_var_url_path)
      }

      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read space.read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "Get2SpacesIdBuyersResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    },
    #' Retrieve Tweets from a Space.
    #'
    #' @description
    #' Retrieve Tweets from a Space.
    #'
    #' @param id The ID of the Space to be retrieved.
    #' @param max_results (optional) The number of Tweets to fetch from the provided space. If not provided, the value will default to the maximum of 100. (default value: 100)
    #' @param tweet_fields (optional) A comma separated list of Tweet fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param media_fields (optional) A comma separated list of Media fields to display.
    #' @param poll_fields (optional) A comma separated list of Poll fields to display.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param place_fields (optional) A comma separated list of Place fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return Get2SpacesIdTweetsResponse
    #' @export
    space_tweets = function(id, max_results = 100, tweet_fields = NULL, expansions = NULL, media_fields = NULL, poll_fields = NULL, user_fields = NULL, place_fields = NULL, data_file = NULL, ...) {
      local_var_response <- self$space_tweets_with_http_info(id, max_results, tweet_fields, expansions, media_fields, poll_fields, user_fields, place_fields, data_file = data_file, ...)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        local_var_response$content
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        local_var_response
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        local_var_response
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        local_var_response
      }
    },
    #' Retrieve Tweets from a Space.
    #'
    #' @description
    #' Retrieve Tweets from a Space.
    #'
    #' @param id The ID of the Space to be retrieved.
    #' @param max_results (optional) The number of Tweets to fetch from the provided space. If not provided, the value will default to the maximum of 100. (default value: 100)
    #' @param tweet_fields (optional) A comma separated list of Tweet fields to display.
    #' @param expansions (optional) A comma separated list of fields to expand.
    #' @param media_fields (optional) A comma separated list of Media fields to display.
    #' @param poll_fields (optional) A comma separated list of Poll fields to display.
    #' @param user_fields (optional) A comma separated list of User fields to display.
    #' @param place_fields (optional) A comma separated list of Place fields to display.
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @return API response (Get2SpacesIdTweetsResponse) with additional information such as HTTP status code, headers
    #' @export
    space_tweets_with_http_info = function(id, max_results = 100, tweet_fields = NULL, expansions = NULL, media_fields = NULL, poll_fields = NULL, user_fields = NULL, place_fields = NULL, data_file = NULL, ...) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`id`)) {
        rlang::abort(message = "Missing required parameter `id`.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Missing required parameter `id`."))
      }

      if (!str_detect(`id`, "^[a-zA-Z0-9]{1,13}$")) {
        rlang::abort(message = "Invalid value for `id` when calling SpacesApi$space_tweets, must conform to the pattern ^[a-zA-Z0-9]{1,13}$.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `id` when calling SpacesApi$space_tweets, must conform to the pattern ^[a-zA-Z0-9]{1,13}$."))
      }

      if (`max_results` > 100) {
        rlang::abort(message = "Invalid value for `max_results` when calling SpacesApi$space_tweets, must be smaller than or equal to 100.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `max_results` when calling SpacesApi$space_tweets, must be smaller than or equal to 100."))
      }
      if (`max_results` < 1) {
        rlang::abort(message = "Invalid value for `max_results` when calling SpacesApi$space_tweets, must be bigger than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid value for `max_results` when calling SpacesApi$space_tweets, must be bigger than or equal to 1."))
      }

      if (length(`tweet_fields`) < 1) {
        rlang::abort(message = "Invalid length for `tweet_fields` when calling SpacesApi$space_tweets, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `tweet_fields` when calling SpacesApi$space_tweets, number of items must be greater than or equal to 1."))
      }

      if (length(`expansions`) < 1) {
        rlang::abort(message = "Invalid length for `expansions` when calling SpacesApi$space_tweets, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `expansions` when calling SpacesApi$space_tweets, number of items must be greater than or equal to 1."))
      }

      if (length(`media_fields`) < 1) {
        rlang::abort(message = "Invalid length for `media_fields` when calling SpacesApi$space_tweets, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `media_fields` when calling SpacesApi$space_tweets, number of items must be greater than or equal to 1."))
      }

      if (length(`poll_fields`) < 1) {
        rlang::abort(message = "Invalid length for `poll_fields` when calling SpacesApi$space_tweets, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `poll_fields` when calling SpacesApi$space_tweets, number of items must be greater than or equal to 1."))
      }

      if (length(`user_fields`) < 1) {
        rlang::abort(message = "Invalid length for `user_fields` when calling SpacesApi$space_tweets, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `user_fields` when calling SpacesApi$space_tweets, number of items must be greater than or equal to 1."))
      }

      if (length(`place_fields`) < 1) {
        rlang::abort(message = "Invalid length for `place_fields` when calling SpacesApi$space_tweets, number of items must be greater than or equal to 1.",
                     .subclass = "ApiException",
                     ApiException = ApiException$new(status = 0,
                                                     reason = "Invalid length for `place_fields` when calling SpacesApi$space_tweets, number of items must be greater than or equal to 1."))
      }

      query_params["max_results"] <- `max_results`

      for (query_item in `tweet_fields`) {
        query_params[["tweet.fields"]] <- c(query_params[["tweet.fields"]], list(`tweet.fields` = query_item))
      }

      for (query_item in `expansions`) {
        query_params[["expansions"]] <- c(query_params[["expansions"]], list(`expansions` = query_item))
      }

      for (query_item in `media_fields`) {
        query_params[["media.fields"]] <- c(query_params[["media.fields"]], list(`media.fields` = query_item))
      }

      for (query_item in `poll_fields`) {
        query_params[["poll.fields"]] <- c(query_params[["poll.fields"]], list(`poll.fields` = query_item))
      }

      for (query_item in `user_fields`) {
        query_params[["user.fields"]] <- c(query_params[["user.fields"]], list(`user.fields` = query_item))
      }

      for (query_item in `place_fields`) {
        query_params[["place.fields"]] <- c(query_params[["place.fields"]], list(`place.fields` = query_item))
      }

      local_var_url_path <- "/2/spaces/{id}/tweets"
      if (!missing(`id`)) {
        local_var_url_path <- gsub(paste0("\\{", "id", "\\}"), URLencode(as.character(`id`), reserved = TRUE), local_var_url_path)
      }

      # Bearer token
      if (!is.null(self$api_client$bearer_token)) {
        header_params["Authorization"] <- paste("Bearer", self$api_client$bearer_token, sep = " ")
      }
      # OAuth-related settings
      is_oauth <- TRUE
      oauth_scopes <- "users.read tweet.read space.read"

      # The Accept request HTTP header
      local_var_accepts <- list("application/json", "application/problem+json")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
            write(local_var_resp$response, data_file)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$deserialize(local_var_resp$response, "Get2SpacesIdTweetsResponse", loadNamespace("twitter")),
          error = function(e) {
             rlang::abort(message = "Failed to deserialize response",
                          .subclass = "ApiException",
                          ApiException = ApiException$new(http_response = local_var_resp))
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        local_var_resp
      } else if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- paste("Server returned ", local_var_resp$status_code, " response status code.")
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api client exception encountered."
        }
        rlang::abort(message = local_var_error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        local_var_error_msg <- local_var_resp$response
        if (local_var_error_msg == "") {
          local_var_error_msg <- "Api server exception encountered."
        }
        rlang::abort(message = error_msg,
                     .subclass = "ApiException",
                     ApiException = ApiException$new(http_response = local_var_resp))
      }
    }
  )
)
